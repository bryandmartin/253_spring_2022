<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>R Cheatsheet | STAT 253: Statistical Machine Learning</title>
  <meta name="description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="R Cheatsheet | STAT 253: Statistical Machine Learning" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  <meta name="github-repo" content="bryandmartin/253_spring_2022" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R Cheatsheet | STAT 253: Statistical Machine Learning" />
  
  <meta name="twitter:description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-resources.html"/>
<link rel="next" href="introductions.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="custom_styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href = "./">STAT 253: Statistical Machine Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="learning-goals.html"><a href="learning-goals.html"><i class="fa fa-check"></i>Learning Goals</a>
<ul>
<li class="chapter" data-level="" data-path="learning-goals.html"><a href="learning-goals.html#general-skills"><i class="fa fa-check"></i>General Skills</a></li>
<li class="chapter" data-level="" data-path="learning-goals.html"><a href="learning-goals.html#course-topics"><i class="fa fa-check"></i>Course Topics</a></li>
</ul></li>
<li class="part"><span><b>I R</b></span></li>
<li class="chapter" data-level="" data-path="r-and-rstudio-setup.html"><a href="r-and-rstudio-setup.html"><i class="fa fa-check"></i>R and RStudio Setup</a>
<ul>
<li class="chapter" data-level="" data-path="r-and-rstudio-setup.html"><a href="r-and-rstudio-setup.html#troubleshooting"><i class="fa fa-check"></i>Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html"><i class="fa fa-check"></i>R Resources</a>
<ul>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#tidymodels-resources"><i class="fa fa-check"></i>Tidymodels resources</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#tidyverse-resources"><i class="fa fa-check"></i>Tidyverse resources</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#visualization-resources"><i class="fa fa-check"></i>Visualization resources</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#general-r-resources"><i class="fa fa-check"></i>General R resources</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#free-online-textbooks"><i class="fa fa-check"></i>Free online textbooks</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#example-code"><i class="fa fa-check"></i>Example code</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html"><i class="fa fa-check"></i>R Cheatsheet</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#stat-155-review"><i class="fa fa-check"></i>Stat 155 Review</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#standard-linear-regression-models"><i class="fa fa-check"></i>Standard Linear Regression Models</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#standard-logistic-regression-models"><i class="fa fa-check"></i>Standard Logistic Regression Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#data-structures-and-purrr-package"><i class="fa fa-check"></i>Data Structures and Purrr Package</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#vectors-and-lists"><i class="fa fa-check"></i>Vectors and Lists</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#map"><i class="fa fa-check"></i>Map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#tidymodels-functions"><i class="fa fa-check"></i>Tidymodels Functions</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#model-specification"><i class="fa fa-check"></i>Model Specification</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#preprocessing-data"><i class="fa fa-check"></i>Preprocessing Data</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#data-subsets"><i class="fa fa-check"></i>Data Subsets</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#workflows"><i class="fa fa-check"></i>Workflows</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#fit-model"><i class="fa fa-check"></i>Fit Model</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#evaluate-model-metrics"><i class="fa fa-check"></i>Evaluate Model: Metrics</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#tune-model-choosing-tuning-parameters"><i class="fa fa-check"></i>Tune Model: Choosing tuning parameters</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#use-final-model-predictions"><i class="fa fa-check"></i>Use Final Model: Predictions</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#extraction"><i class="fa fa-check"></i>Extraction</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#variable-importance"><i class="fa fa-check"></i>Variable Importance</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#comparing-models-workflow-sets"><i class="fa fa-check"></i>Comparing Models: Workflow Sets</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#visualizing-fit-models"><i class="fa fa-check"></i>Visualizing Fit Models</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#visualize-coefficients"><i class="fa fa-check"></i>Visualize Coefficients</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#visualize-effects"><i class="fa fa-check"></i>Visualize Effects</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#visualize-residuals"><i class="fa fa-check"></i>Visualize Residuals</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#visualize-predictions"><i class="fa fa-check"></i>Visualize Predictions</a></li>
<li class="chapter" data-level="0.0.1" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#visualize-lasso-coefficients"><i class="fa fa-check"></i><b>0.0.1</b> Visualize LASSO Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#real-data-example-regression"><i class="fa fa-check"></i>Real Data Example: Regression</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#linear-regression"><i class="fa fa-check"></i>Linear Regression</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#regularized-regression"><i class="fa fa-check"></i>Regularized Regression</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#nearest-neighbors"><i class="fa fa-check"></i>Nearest Neighbors</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#gams---splines-and-local-regression"><i class="fa fa-check"></i>GAMs - Splines and Local Regression</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#gam---smoothing-splines"><i class="fa fa-check"></i>GAM - Smoothing Splines</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#regression-trees"><i class="fa fa-check"></i>Regression Trees</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#comparison-of-methods"><i class="fa fa-check"></i>Comparison of Methods</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#real-data-example-classification"><i class="fa fa-check"></i>Real Data Example: Classification</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#logistic-regression"><i class="fa fa-check"></i>Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#regularized-logistic-regression"><i class="fa fa-check"></i>Regularized Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#classification-trees"><i class="fa fa-check"></i>Classification Trees</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#random-forest"><i class="fa fa-check"></i>Random Forest</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#comparison-of-methods-1"><i class="fa fa-check"></i>Comparison of Methods</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#real-data-example-clustering"><i class="fa fa-check"></i>Real Data Example: Clustering</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#real-data-example-dimension-reduction"><i class="fa fa-check"></i>Real Data Example: Dimension Reduction</a></li>
</ul></li>
<li class="part"><span><b>II Introductions</b></span></li>
<li class="chapter" data-level="1" data-path="introductions.html"><a href="introductions.html"><i class="fa fa-check"></i><b>1</b> Introductions</a>
<ul>
<li class="chapter" data-level="" data-path="introductions.html"><a href="introductions.html#envisioning-a-community-of-learners"><i class="fa fa-check"></i>Envisioning a Community of Learners</a></li>
<li class="chapter" data-level="" data-path="introductions.html"><a href="introductions.html#explorations"><i class="fa fa-check"></i>Explorations</a></li>
</ul></li>
<li class="part"><span><b>III Regression: Evaluation</b></span></li>
<li class="chapter" data-level="2" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html"><i class="fa fa-check"></i><b>2</b> Evaluating Regression Models</a>
<ul>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#learning-goals-1"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercises"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#context"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#class-investigations"><i class="fa fa-check"></i>Class investigations</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="overfitting.html"><a href="overfitting.html"><i class="fa fa-check"></i><b>3</b> Overfitting</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#learning-goals-2"><i class="fa fa-check"></i>Learning Goals</a></li>
<li><a href="overfitting.html#the-tidymodels-package">The <code>tidymodels</code> package</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercises-1"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#context-1"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-1-5-models"><i class="fa fa-check"></i>Exercise 1: 5 models</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-2-visualizing-predictions"><i class="fa fa-check"></i>Exercise 2: Visualizing Predictions</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-3-evaluating-on-test-data"><i class="fa fa-check"></i>Exercise 3: Evaluating on Test Data</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-4-overfitting"><i class="fa fa-check"></i>Exercise 4: Overfitting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cross-validation.html"><a href="cross-validation.html"><i class="fa fa-check"></i><b>4</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#learning-goals-3"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#writing-good-sentences"><i class="fa fa-check"></i>Writing Good Sentences</a>
<ul>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#instructions"><i class="fa fa-check"></i>Instructions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercises-2"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#context-2"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-1-cross-validation-in-concept"><i class="fa fa-check"></i>Exercise 1: Cross-validation in Concept</a></li>
<li><a href="cross-validation.html#exercise-2-cross-validation-with-tidymodels">Exercise 2: Cross-validation with <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-3-looking-at-the-evaluation-metrics"><i class="fa fa-check"></i>Exercise 3: Looking at the evaluation metrics</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-4-practical-issues-choosing-the-number-of-folds"><i class="fa fa-check"></i>Exercise 4: Practical issues: choosing the number of folds</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#digging-deeper"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Regression: Building Models</b></span></li>
<li class="chapter" data-level="5" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html"><i class="fa fa-check"></i><b>5</b> Variable Subset Selection</a>
<ul>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#learning-goals-4"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#writing-good-sentences-part-2"><i class="fa fa-check"></i>Writing Good Sentences Part 2</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercises-3"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-1-backward-stepwise-selection-by-hand"><i class="fa fa-check"></i>Exercise 1: Backward stepwise selection: by hand</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-2-interpreting-the-results"><i class="fa fa-check"></i>Exercise 2: Interpreting the results</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-3-planning-forward-selection-using-cv"><i class="fa fa-check"></i>Exercise 3: Planning forward selection using CV</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-4-approaches-to-variable-subset-selection"><i class="fa fa-check"></i>Exercise 4: Approaches to variable subset selection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html"><i class="fa fa-check"></i><b>6</b> LASSO: Shrinkage/Regularization</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#learning-goals-5"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#lasso-in-theory"><i class="fa fa-check"></i>LASSO in Theory</a></li>
<li><a href="lasso-shrinkageregularization.html#lasso-models-in-tidymodels">LASSO models in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercises-4"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-1-a-least-squares-model"><i class="fa fa-check"></i>Exercise 1: A least squares model</a></li>
<li><a href="lasso-shrinkageregularization.html#exercise-2-fitting-a-lasso-model-in-tidymodels">Exercise 2: Fitting a LASSO model in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-3-examining-output-plot-of-coefficient-paths"><i class="fa fa-check"></i>Exercise 3: Examining output: plot of coefficient paths</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-4-examining-and-evaluating-the-best-lasso-model"><i class="fa fa-check"></i>Exercise 4: Examining and evaluating the best LASSO model</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#digging-deeper-1"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Regression: Building Flexible Models</b></span></li>
<li class="chapter" data-level="7" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html"><i class="fa fa-check"></i><b>7</b> KNN Regression and the Bias-Variance Tradeoff</a>
<ul>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#learning-goals-6"><i class="fa fa-check"></i>Learning Goals</a></li>
<li><a href="knn-regression-and-the-bias-variance-tradeoff.html#knn-models-in-tidymodels">KNN models in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercises-5"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#hello-how-are-things"><i class="fa fa-check"></i>Hello, how are things?</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-1-bias-variance-tradeoff-warmup"><i class="fa fa-check"></i>Exercise 1: Bias-variance tradeoff warmup</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-2-impact-of-variable-scale-and-distance-measure"><i class="fa fa-check"></i>Exercise 2: Impact of variable scale and distance measure</a></li>
<li><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-3-implementing-knn-in-tidymodels">Exercise 3: Implementing KNN in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-4-inspecting-the-results"><i class="fa fa-check"></i>Exercise 4: Inspecting the results</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-5-curse-of-dimensionality"><i class="fa fa-check"></i>Exercise 5: Curse of dimensionality</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="catch-up-day.html"><a href="catch-up-day.html"><i class="fa fa-check"></i><b>8</b> Catch up Day</a>
<ul>
<li class="chapter" data-level="" data-path="catch-up-day.html"><a href="catch-up-day.html#learning-goals-7"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="catch-up-day.html"><a href="catch-up-day.html#content-conversation-1-prompts"><i class="fa fa-check"></i>Content Conversation 1 Prompts</a></li>
<li class="chapter" data-level="" data-path="catch-up-day.html"><a href="catch-up-day.html#peer-review"><i class="fa fa-check"></i>Peer Review</a></li>
<li class="chapter" data-level="" data-path="catch-up-day.html"><a href="catch-up-day.html#project-work"><i class="fa fa-check"></i>Project Work</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="splines.html"><a href="splines.html"><i class="fa fa-check"></i><b>9</b> Splines</a>
<ul>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#learning-goals-8"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#splines-1"><i class="fa fa-check"></i>Splines</a></li>
<li><a href="splines.html#splines-in-tidymodels">Splines in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#exercises-6"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#exercise-1-evaluating-a-fully-linear-model"><i class="fa fa-check"></i>Exercise 1: Evaluating a fully linear model</a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#exercise-2-evaluating-a-spline-model"><i class="fa fa-check"></i>Exercise 2: Evaluating a spline model</a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#extra-variable-scaling"><i class="fa fa-check"></i>Extra! Variable scaling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="local-regression-gams.html"><a href="local-regression-gams.html"><i class="fa fa-check"></i><b>10</b> Local Regression &amp; GAMs</a>
<ul>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#learning-goals-9"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#gams"><i class="fa fa-check"></i>GAMs</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#gams---options-for-fitting"><i class="fa fa-check"></i>GAMs - Options for Fitting</a>
<ul>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#gams-b-splines-ols"><i class="fa fa-check"></i>GAMs (B-splines + OLS)</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#gams-loess"><i class="fa fa-check"></i>GAMs (LOESS)</a></li>
<li><a href="local-regression-gams.html#gams-smoothing-splines-in-tidymodels">GAMs (smoothing splines) in <code>tidymodels</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercises-7"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-1-conceptual-warmup"><i class="fa fa-check"></i>Exercise 1: Conceptual warmup</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-2-using-loess"><i class="fa fa-check"></i>Exercise 2: Using LOESS</a></li>
<li><a href="local-regression-gams.html#exercise-3-building-a-gam-in-tidymodels">Exercise 3: Building a GAM in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-4-adjusting-the-best-gam"><i class="fa fa-check"></i>Exercise 4: Adjusting the “best” GAM</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-5-gam-with-recipes"><i class="fa fa-check"></i>Exercise 5: GAM with recipes</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-6-comparison-of-methods"><i class="fa fa-check"></i>Exercise 6: Comparison of methods</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VI Classification</b></span></li>
<li class="chapter" data-level="11" data-path="logistic-regression-evaluation.html"><a href="logistic-regression-evaluation.html"><i class="fa fa-check"></i><b>11</b> Logistic Regression &amp; Evaluation</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression-evaluation.html"><a href="logistic-regression-evaluation.html#learning-goals-10"><i class="fa fa-check"></i>Learning Goals</a></li>
<li><a href="logistic-regression-evaluation.html#logistic-regression-in-tidymodels">Logistic regression in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="logistic-regression-evaluation.html"><a href="logistic-regression-evaluation.html#exercises-8"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression-evaluation.html"><a href="logistic-regression-evaluation.html#context-3"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="logistic-regression-evaluation.html"><a href="logistic-regression-evaluation.html#exercise-1-visualization-warmup"><i class="fa fa-check"></i>Exercise 1: Visualization warmup</a></li>
<li><a href="logistic-regression-evaluation.html#exercise-2-implementing-logistic-regression-in-tidymodels">Exercise 2: Implementing logistic regression in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="logistic-regression-evaluation.html"><a href="logistic-regression-evaluation.html#exercise-3-interpreting-the-model"><i class="fa fa-check"></i>Exercise 3: Interpreting the model</a></li>
<li class="chapter" data-level="" data-path="logistic-regression-evaluation.html"><a href="logistic-regression-evaluation.html#exercise-4-making-predictions"><i class="fa fa-check"></i>Exercise 4: Making predictions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression-evaluation.html"><a href="logistic-regression-evaluation.html#exercise-5-evaluate-the-model"><i class="fa fa-check"></i>Exercise 5: Evaluate the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html"><i class="fa fa-check"></i><b>12</b> Lasso &amp; Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#learning-goals-11"><i class="fa fa-check"></i>Learning Goals</a></li>
<li><a href="lasso-logistic-regression.html#lasso-for-logistic-regression-in-tidymodels">LASSO for logistic regression in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#exercises-9"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#context-4"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#exercise-1-conceptual-warmup-1"><i class="fa fa-check"></i>Exercise 1: Conceptual warmup</a></li>
<li><a href="lasso-logistic-regression.html#exercise-2-implementing-lasso-logistic-regression-in-tidymodels">Exercise 2: Implementing LASSO logistic regression in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#exercise-3-inspecting-the-model"><i class="fa fa-check"></i>Exercise 3: Inspecting the model</a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#exercise-4-interpreting-evaluation-metrics"><i class="fa fa-check"></i>Exercise 4: Interpreting evaluation metrics</a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#exercise-5-using-the-final-model-choosing-a-threshold"><i class="fa fa-check"></i>Exercise 5: Using the final model (choosing a threshold)</a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#exercise-6-algorithmic-understanding-for-evaluation-metrics"><i class="fa fa-check"></i>Exercise 6: Algorithmic understanding for evaluation metrics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="trees.html"><a href="trees.html"><i class="fa fa-check"></i><b>13</b> Trees</a>
<ul>
<li class="chapter" data-level="" data-path="trees.html"><a href="trees.html#learning-goals-12"><i class="fa fa-check"></i>Learning Goals</a></li>
<li><a href="trees.html#trees-in-tidymodels">Trees in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="trees.html"><a href="trees.html#exercises-10"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="trees.html"><a href="trees.html#context-5"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="trees.html"><a href="trees.html#exercise-1-core-theme-parametricnonparametric"><i class="fa fa-check"></i>Exercise 1: Core theme: parametric/nonparametric</a></li>
<li class="chapter" data-level="" data-path="trees.html"><a href="trees.html#exercise-2-core-theme-tuning-parameters-and-the-bvt"><i class="fa fa-check"></i>Exercise 2: Core theme: Tuning parameters and the BVT</a></li>
<li><a href="trees.html#exercise-3-building-tuning-trees-in-tidymodels">Exercise 3: Building &amp; tuning trees in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="trees.html"><a href="trees.html#exercise-4-visualizing-trees"><i class="fa fa-check"></i>Exercise 4: Visualizing trees</a></li>
<li class="chapter" data-level="" data-path="trees.html"><a href="trees.html#exercise-5-predictions-from-trees"><i class="fa fa-check"></i>Exercise 5: Predictions from trees</a></li>
<li class="chapter" data-level="" data-path="trees.html"><a href="trees.html#exercise-6-variable-importance-in-trees"><i class="fa fa-check"></i>Exercise 6: Variable importance in trees</a></li>
<li class="chapter" data-level="" data-path="trees.html"><a href="trees.html#extra-regression-trees"><i class="fa fa-check"></i>Extra! Regression Trees!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="bagging-and-random-forests.html"><a href="bagging-and-random-forests.html"><i class="fa fa-check"></i><b>14</b> Bagging and Random Forests</a>
<ul>
<li class="chapter" data-level="" data-path="bagging-and-random-forests.html"><a href="bagging-and-random-forests.html#learning-goals-13"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="bagging-and-random-forests.html"><a href="bagging-and-random-forests.html#exercises-11"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="bagging-and-random-forests.html"><a href="bagging-and-random-forests.html#hello-how-are-things-1"><i class="fa fa-check"></i>Hello, how are things?</a></li>
<li class="chapter" data-level="" data-path="bagging-and-random-forests.html"><a href="bagging-and-random-forests.html#exercise-1-bagging-bootstrap-aggregation"><i class="fa fa-check"></i>Exercise 1: Bagging: Bootstrap Aggregation</a></li>
<li class="chapter" data-level="" data-path="bagging-and-random-forests.html"><a href="bagging-and-random-forests.html#exercise-2-preparation-to-build-a-random-forest"><i class="fa fa-check"></i>Exercise 2: Preparation to build a random forest</a></li>
<li class="chapter" data-level="" data-path="bagging-and-random-forests.html"><a href="bagging-and-random-forests.html#exercise-3-building-the-random-forest"><i class="fa fa-check"></i>Exercise 3: Building the random forest</a></li>
<li class="chapter" data-level="" data-path="bagging-and-random-forests.html"><a href="bagging-and-random-forests.html#exercise-4-preliminary-interpretation"><i class="fa fa-check"></i>Exercise 4: Preliminary interpretation</a></li>
<li class="chapter" data-level="" data-path="bagging-and-random-forests.html"><a href="bagging-and-random-forests.html#exercise-5-evaluating-the-forest"><i class="fa fa-check"></i>Exercise 5: Evaluating the forest</a></li>
<li class="chapter" data-level="" data-path="bagging-and-random-forests.html"><a href="bagging-and-random-forests.html#exercise-6-variable-importance-measures"><i class="fa fa-check"></i>Exercise 6: Variable importance measures</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII Homework</b></span></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html"><i class="fa fa-check"></i>Homework 1</a>
<ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#project-work-1"><i class="fa fa-check"></i>Project Work</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#portfolio-work"><i class="fa fa-check"></i>Portfolio Work</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#reflection"><i class="fa fa-check"></i>Reflection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i>Homework 2</a>
<ul>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#project-work-2"><i class="fa fa-check"></i>Project Work</a>
<ul>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#instructions-1"><i class="fa fa-check"></i>Instructions</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#required-analyses"><i class="fa fa-check"></i>Required Analyses</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#portfolio-work-1"><i class="fa fa-check"></i>Portfolio Work</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#reflection-1"><i class="fa fa-check"></i>Reflection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html"><i class="fa fa-check"></i>Homework 3</a>
<ul>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#project-work-3"><i class="fa fa-check"></i>Project Work</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#portfolio-work-2"><i class="fa fa-check"></i>Portfolio Work</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#reflection-2"><i class="fa fa-check"></i>Reflection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html"><i class="fa fa-check"></i>Homework 4</a>
<ul>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#project-work-4"><i class="fa fa-check"></i>Project Work</a>
<ul>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#open-communication-about-expectations-and-goals"><i class="fa fa-check"></i>Open Communication about Expectations and Goals</a></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#delegation-of-analysis"><i class="fa fa-check"></i>Delegation of Analysis</a></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#required-analysis"><i class="fa fa-check"></i>Required Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#portfolio-work-3"><i class="fa fa-check"></i>Portfolio Work</a></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#reflection-3"><i class="fa fa-check"></i>Reflection</a></li>
</ul></li>
<li class="part"><span><b>VIII Project</b></span></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html"><i class="fa fa-check"></i>Final Project</a>
<ul>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#requirements"><i class="fa fa-check"></i>Requirements</a></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#expectations"><i class="fa fa-check"></i>Expectations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 253: Statistical Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-cheatsheet" class="section level1 unnumbered">
<h1>R Cheatsheet</h1>
<p>This cheatsheet is a work in progress. It will be updated and improved throughout the semester.</p>
<div id="stat-155-review" class="section level2 unnumbered">
<h2>Stat 155 Review</h2>
<div id="standard-linear-regression-models" class="section level3 unnumbered">
<h3>Standard Linear Regression Models</h3>
<p>To fit a linear model, start with a formula to specify variable roles and which variable is the predictor variable (left hand side before ~). The <code>lm</code> function formats variables for you by creating indicator variables for factor/categorical variables.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="r-cheatsheet.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predictor variables have pluses between them</span></span>
<span id="cb5-2"><a href="r-cheatsheet.html#cb5-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2 </span>
<span id="cb5-3"><a href="r-cheatsheet.html#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="r-cheatsheet.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># specifies least squares estimation of the linear model specified by the formula using the data provided</span></span>
<span id="cb5-5"><a href="r-cheatsheet.html#cb5-5" aria-hidden="true" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, data) </span>
<span id="cb5-6"><a href="r-cheatsheet.html#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="r-cheatsheet.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># provides an overall summary of the fit model</span></span>
<span id="cb5-8"><a href="r-cheatsheet.html#cb5-8" aria-hidden="true" tabindex="-1"></a>fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="r-cheatsheet.html#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() </span>
<span id="cb5-10"><a href="r-cheatsheet.html#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="r-cheatsheet.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># provides a data frame of the estimated coefficients, standard errors, and information for individual coefficient hypothesis tests</span></span>
<span id="cb5-12"><a href="r-cheatsheet.html#cb5-12" aria-hidden="true" tabindex="-1"></a>fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb5-13"><a href="r-cheatsheet.html#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() </span>
<span id="cb5-14"><a href="r-cheatsheet.html#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="r-cheatsheet.html#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># provides many model summaries including rsquared and sigma (the estimated sd of residuals)</span></span>
<span id="cb5-16"><a href="r-cheatsheet.html#cb5-16" aria-hidden="true" tabindex="-1"></a>fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb5-17"><a href="r-cheatsheet.html#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>()</span>
<span id="cb5-18"><a href="r-cheatsheet.html#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="r-cheatsheet.html#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># provides a data set that includes the original variables as well as the residuals and fitted values; used to plot residuals</span></span>
<span id="cb5-20"><a href="r-cheatsheet.html#cb5-20" aria-hidden="true" tabindex="-1"></a>fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb5-21"><a href="r-cheatsheet.html#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>()</span>
<span id="cb5-22"><a href="r-cheatsheet.html#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="r-cheatsheet.html#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co"># predict outcome values based on the fit model for newdata</span></span>
<span id="cb5-24"><a href="r-cheatsheet.html#cb5-24" aria-hidden="true" tabindex="-1"></a>fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb5-25"><a href="r-cheatsheet.html#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(newdata) </span></code></pre></div>
</div>
<div id="standard-logistic-regression-models" class="section level3 unnumbered">
<h3>Standard Logistic Regression Models</h3>
<p>To fit a linear model, start with a formula to specify variable roles and which variable is the predictor variable (left hand side before ~). The <code>glm</code> function formats variables for you by creating indicator variables for factor/categorical variables. Make sure that your outcome variable <code>y</code> is an indicator variable (0/1 or FALSE/TRUE).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="r-cheatsheet.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predictor variables have pluses between them</span></span>
<span id="cb6-2"><a href="r-cheatsheet.html#cb6-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2 </span>
<span id="cb6-3"><a href="r-cheatsheet.html#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="r-cheatsheet.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># specifies maximum likelihood estimation of the generalized linear model specified by the formula using the data provided; when family = &#39;binomial&#39;, it fits a logistic regression model rather than a linear model</span></span>
<span id="cb6-5"><a href="r-cheatsheet.html#cb6-5" aria-hidden="true" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(formula, data, <span class="at">family =</span> <span class="st">&#39;binomial&#39;</span>) </span>
<span id="cb6-6"><a href="r-cheatsheet.html#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="r-cheatsheet.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># provides an overall summary of the fit model</span></span>
<span id="cb6-8"><a href="r-cheatsheet.html#cb6-8" aria-hidden="true" tabindex="-1"></a>fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="r-cheatsheet.html#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() </span>
<span id="cb6-10"><a href="r-cheatsheet.html#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="r-cheatsheet.html#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># provides a data frame of the estimated coefficients, standard errors, and information for individual coefficient hypothesis tests</span></span>
<span id="cb6-12"><a href="r-cheatsheet.html#cb6-12" aria-hidden="true" tabindex="-1"></a>fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb6-13"><a href="r-cheatsheet.html#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() </span>
<span id="cb6-14"><a href="r-cheatsheet.html#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="r-cheatsheet.html#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># predict probability of outcome values based on the fit model for newdata</span></span>
<span id="cb6-16"><a href="r-cheatsheet.html#cb6-16" aria-hidden="true" tabindex="-1"></a>fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb6-17"><a href="r-cheatsheet.html#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(newdata, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>) </span>
<span id="cb6-18"><a href="r-cheatsheet.html#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="r-cheatsheet.html#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate specificity, false positive rate, false negative rate, and sensitivity</span></span>
<span id="cb6-20"><a href="r-cheatsheet.html#cb6-20" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fl">0.25</span> <span class="co"># you choose threshold</span></span>
<span id="cb6-21"><a href="r-cheatsheet.html#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="r-cheatsheet.html#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(fit_model, <span class="at">type.predict =</span><span class="st">&#39;response&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="r-cheatsheet.html#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predOutcome =</span> .fitted <span class="sc">&gt;=</span> threshold) <span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="r-cheatsheet.html#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(y, predOutcome) <span class="sc">%&gt;%</span></span>
<span id="cb6-25"><a href="r-cheatsheet.html#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">correct =</span> (y <span class="sc">==</span> predictOutcome)) <span class="sc">%&gt;%</span></span>
<span id="cb6-26"><a href="r-cheatsheet.html#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(y) <span class="sc">%&gt;%</span> <span class="co"># condition on the true y outcome value</span></span>
<span id="cb6-27"><a href="r-cheatsheet.html#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n))</span></code></pre></div>
</div>
</div>
<div id="data-structures-and-purrr-package" class="section level2 unnumbered">
<h2>Data Structures and Purrr Package</h2>
<div id="vectors-and-lists" class="section level3 unnumbered">
<h3>Vectors and Lists</h3>
<p>In R, there are many data structures. Read <a href="http://adv-r.had.co.nz/Data-structures.html" class="uri">http://adv-r.had.co.nz/Data-structures.html</a> for more information.</p>
<p>The two most basic types of data structures are vectors and lists.</p>
<div id="vectors" class="section level4 unnumbered">
<h4>Vectors</h4>
<ul>
<li><p><strong>Atomic Vector</strong> (numeric, character, integer, logical)</p>
<ul>
<li>All elements of an atomic vector must have the same type (numeric/double, character, integer, logical/boolean).</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="r-cheatsheet.html#cb7-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> </span>
<span id="cb7-2"><a href="r-cheatsheet.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(x) <span class="co"># atomic type</span></span>
<span id="cb7-3"><a href="r-cheatsheet.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x) <span class="co"># object class name</span></span>
<span id="cb7-4"><a href="r-cheatsheet.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">is.integer</span>(x)</span>
<span id="cb7-5"><a href="r-cheatsheet.html#cb7-5" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb7-6"><a href="r-cheatsheet.html#cb7-6" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="co">#access elements in vector with []</span></span>
<span id="cb7-7"><a href="r-cheatsheet.html#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="r-cheatsheet.html#cb7-8" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (x <span class="sc">&gt;</span> <span class="dv">5</span>)</span>
<span id="cb7-9"><a href="r-cheatsheet.html#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(z) </span>
<span id="cb7-10"><a href="r-cheatsheet.html#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(z)</span>
<span id="cb7-11"><a href="r-cheatsheet.html#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">is.logical</span>(z)</span>
<span id="cb7-12"><a href="r-cheatsheet.html#cb7-12" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb7-13"><a href="r-cheatsheet.html#cb7-13" aria-hidden="true" tabindex="-1"></a>z[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]</span>
<span id="cb7-14"><a href="r-cheatsheet.html#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="r-cheatsheet.html#cb7-15" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">if_else</span>(x <span class="sc">&gt;</span> <span class="dv">5</span>, <span class="st">&#39;greater than 5&#39;</span>,<span class="st">&#39;less than or equal to 5&#39;</span>)</span>
<span id="cb7-16"><a href="r-cheatsheet.html#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(y) </span>
<span id="cb7-17"><a href="r-cheatsheet.html#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(y)</span>
<span id="cb7-18"><a href="r-cheatsheet.html#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="fu">is.character</span>(y)</span>
<span id="cb7-19"><a href="r-cheatsheet.html#cb7-19" aria-hidden="true" tabindex="-1"></a>y</span>
<span id="cb7-20"><a href="r-cheatsheet.html#cb7-20" aria-hidden="true" tabindex="-1"></a>y[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)]</span>
<span id="cb7-21"><a href="r-cheatsheet.html#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="r-cheatsheet.html#cb7-22" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> x <span class="sc">+</span> .<span class="dv">2</span></span>
<span id="cb7-23"><a href="r-cheatsheet.html#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(v) </span>
<span id="cb7-24"><a href="r-cheatsheet.html#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(v)</span>
<span id="cb7-25"><a href="r-cheatsheet.html#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(v)</span>
<span id="cb7-26"><a href="r-cheatsheet.html#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="fu">is.double</span>(v)</span></code></pre></div>
<p>Factors are vectors with special attributes.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="r-cheatsheet.html#cb8-1" aria-hidden="true" tabindex="-1"></a>yfactor <span class="ot">&lt;-</span> <span class="fu">factor</span>(y) </span>
<span id="cb8-2"><a href="r-cheatsheet.html#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="r-cheatsheet.html#cb8-3" aria-hidden="true" tabindex="-1"></a>yfactor <span class="sc">%&gt;%</span> <span class="fu">attributes</span>()</span>
<span id="cb8-4"><a href="r-cheatsheet.html#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="r-cheatsheet.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(yfactor) <span class="co">#underlying a factor is an integer vector, indexing the levels/categories</span></span>
<span id="cb8-6"><a href="r-cheatsheet.html#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="r-cheatsheet.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(yfactor) <span class="co"># first level is reference level</span></span>
<span id="cb8-8"><a href="r-cheatsheet.html#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="r-cheatsheet.html#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">relevel</span>(yfactor, <span class="at">ref=</span><span class="st">&#39;less than or equal to 5&#39;</span>) <span class="co"># can change reference level</span></span></code></pre></div>
</div>
<div id="lists" class="section level4 unnumbered">
<h4>Lists</h4>
<ul>
<li><p><strong>Lists</strong></p>
<ul>
<li>Lists can have elements of differing types. You can even have lists of lists or lists of vectors.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="r-cheatsheet.html#cb9-1" aria-hidden="true" tabindex="-1"></a>l1 <span class="ot">&lt;-</span> <span class="fu">list</span>(x,y,z,v,<span class="dv">2</span>) <span class="co">#unnamed list</span></span>
<span id="cb9-2"><a href="r-cheatsheet.html#cb9-2" aria-hidden="true" tabindex="-1"></a>l1</span>
<span id="cb9-3"><a href="r-cheatsheet.html#cb9-3" aria-hidden="true" tabindex="-1"></a>l1[[<span class="dv">1</span>]] <span class="co">#access elements in list with [[]]</span></span>
<span id="cb9-4"><a href="r-cheatsheet.html#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="r-cheatsheet.html#cb9-5" aria-hidden="true" tabindex="-1"></a>l2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">z =</span> z, <span class="at">v =</span> v, <span class="at">b =</span> <span class="dv">2</span>) <span class="co">#named list</span></span>
<span id="cb9-6"><a href="r-cheatsheet.html#cb9-6" aria-hidden="true" tabindex="-1"></a>l2</span>
<span id="cb9-7"><a href="r-cheatsheet.html#cb9-7" aria-hidden="true" tabindex="-1"></a>l2[[<span class="st">&#39;x&#39;</span>]] <span class="co">#access elements in list with [[]]</span></span>
<span id="cb9-8"><a href="r-cheatsheet.html#cb9-8" aria-hidden="true" tabindex="-1"></a>l2<span class="sc">$</span>x <span class="co">#access elements in named list with $</span></span></code></pre></div>
<p>Data frames and tibbles are special types of named lists. Each element must be a vector, the vectors must have the same length, but they can be different types. Each of these vectors are variables in the data set.</p>
<p>You could have a list of data frames/tibbles.</p>
</div>
</div>
<div id="map" class="section level3 unnumbered">
<h3>Map</h3>
<p>When you want to apply a function to each element in a list or vector of values, you can use <code>map</code> which is a function in the purrr package.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="r-cheatsheet.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Silly example: add 2 to every value in x</span></span>
<span id="cb10-2"><a href="r-cheatsheet.html#cb10-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb10-3"><a href="r-cheatsheet.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(a, <span class="sc">~</span> .x <span class="sc">+</span> <span class="dv">2</span> ) <span class="co"># short hand for code below</span></span>
<span id="cb10-4"><a href="r-cheatsheet.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># map(x, function(x) x + 2 )</span></span>
<span id="cb10-5"><a href="r-cheatsheet.html#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="r-cheatsheet.html#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Real example: fit the same model to 5 different data sets</span></span>
<span id="cb10-7"><a href="r-cheatsheet.html#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="r-cheatsheet.html#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#simulate data</span></span>
<span id="cb10-9"><a href="r-cheatsheet.html#cb10-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>,<span class="dv">0</span>,<span class="dv">10</span>) <span class="co">#500 x values randomly from uniform distribution [0,10]</span></span>
<span id="cb10-10"><a href="r-cheatsheet.html#cb10-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, </span>
<span id="cb10-11"><a href="r-cheatsheet.html#cb10-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="dv">2</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">500</span>), <span class="co">#500 y values equal to 2*x + random value from Normal(0,1)</span></span>
<span id="cb10-12"><a href="r-cheatsheet.html#cb10-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">s =</span> <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">500</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> <span class="co">#500 random values from 1 to 5 (strata/groups)</span></span>
<span id="cb10-13"><a href="r-cheatsheet.html#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(s) <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="r-cheatsheet.html#cb10-14" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">nest</span>() <span class="co"># data frame with variable data that is 5 data sets, one for each group</span></span>
<span id="cb10-15"><a href="r-cheatsheet.html#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="r-cheatsheet.html#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="r-cheatsheet.html#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(df<span class="sc">$</span>data, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> .x)) <span class="co"># short hand for code below</span></span>
<span id="cb10-18"><a href="r-cheatsheet.html#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># map(df$data, function(data) lm(y ~ x, data = data))</span></span></code></pre></div>
</div>
</div>
<div id="tidymodels-functions" class="section level2 unnumbered">
<h2>Tidymodels Functions</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="r-cheatsheet.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)  <span class="co"># Includes the workflows package</span></span>
<span id="cb11-2"><a href="r-cheatsheet.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidymodels_prefer</span>() <span class="co"># Resolves conflicts, prefers tidymodel functions</span></span></code></pre></div>
<div id="model-specification" class="section level3 unnumbered">
<h3>Model Specification</h3>
<p>For more information, see the documentation for the parsnip package (part of the tidymodels package): <a href="https://www.tidymodels.org/find/parsnip/" class="uri">https://www.tidymodels.org/find/parsnip/</a></p>
<div id="types-of-models" class="section level4 unnumbered">
<h4>Types of Models</h4>
<p>For this course, we will only use the following models:</p>
<p><code>linear_reg()</code>, <code>gen_additive_model()</code>, <code>logistic_reg()</code></p>
<p><code>nearest_neighbor()</code>, <code>decision_tree()</code>, <code>rand_forest()</code></p>
</div>
<div id="engines-estimation-methods" class="section level4 unnumbered">
<h4>Engines (Estimation Methods)</h4>
<p>For this course, we will primarily use the following estimation methods/engines.</p>
<p><code>lm</code>, <code>glm</code>, <code>glmnet</code>, <code>kknn</code>, <code>rpart</code>, <code>ranger</code></p>
</div>
<div id="usage" class="section level4 unnumbered">
<h4>Usage</h4>
<div id="regression-models" class="section level5 unnumbered">
<h5>Regression Models</h5>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="r-cheatsheet.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear Regression Model</span></span>
<span id="cb12-2"><a href="r-cheatsheet.html#cb12-2" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span> </span>
<span id="cb12-3"><a href="r-cheatsheet.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="r-cheatsheet.html#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;lm&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="r-cheatsheet.html#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb12-6"><a href="r-cheatsheet.html#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="r-cheatsheet.html#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Lasso Regression Model</span></span>
<span id="cb12-8"><a href="r-cheatsheet.html#cb12-8" aria-hidden="true" tabindex="-1"></a>lm_lasso_spec <span class="ot">&lt;-</span> </span>
<span id="cb12-9"><a href="r-cheatsheet.html#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="r-cheatsheet.html#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> lambda) <span class="sc">%&gt;%</span> <span class="co"># we could let penalty = tune()</span></span>
<span id="cb12-11"><a href="r-cheatsheet.html#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;glmnet&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-12"><a href="r-cheatsheet.html#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb12-13"><a href="r-cheatsheet.html#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="r-cheatsheet.html#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Ridge Regression Model</span></span>
<span id="cb12-15"><a href="r-cheatsheet.html#cb12-15" aria-hidden="true" tabindex="-1"></a>lm_ridge_spec <span class="ot">&lt;-</span> </span>
<span id="cb12-16"><a href="r-cheatsheet.html#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-17"><a href="r-cheatsheet.html#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">0</span>, <span class="at">penalty =</span> lambda) <span class="sc">%&gt;%</span> <span class="co"># we could let penalty = tune()</span></span>
<span id="cb12-18"><a href="r-cheatsheet.html#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;glmnet&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-19"><a href="r-cheatsheet.html#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb12-20"><a href="r-cheatsheet.html#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="r-cheatsheet.html#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co"># K Nearest Neighbors Regression Model</span></span>
<span id="cb12-22"><a href="r-cheatsheet.html#cb12-22" aria-hidden="true" tabindex="-1"></a>knn_spec <span class="ot">&lt;-</span> </span>
<span id="cb12-23"><a href="r-cheatsheet.html#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nearest_neighbor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-24"><a href="r-cheatsheet.html#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_args</span>(<span class="at">neighbors =</span> k) <span class="sc">%&gt;%</span> <span class="co"># we could let neighbors = tune()</span></span>
<span id="cb12-25"><a href="r-cheatsheet.html#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;kknn&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-26"><a href="r-cheatsheet.html#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>)</span>
<span id="cb12-27"><a href="r-cheatsheet.html#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="r-cheatsheet.html#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Generalized Additive Models (with smoothing splines)</span></span>
<span id="cb12-29"><a href="r-cheatsheet.html#cb12-29" aria-hidden="true" tabindex="-1"></a>gam_spec <span class="ot">&lt;-</span> </span>
<span id="cb12-30"><a href="r-cheatsheet.html#cb12-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gen_additive_mod</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-31"><a href="r-cheatsheet.html#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;mgcv&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-32"><a href="r-cheatsheet.html#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb12-33"><a href="r-cheatsheet.html#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="r-cheatsheet.html#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression Tree Model</span></span>
<span id="cb12-35"><a href="r-cheatsheet.html#cb12-35" aria-hidden="true" tabindex="-1"></a>rt_spec <span class="ot">&lt;-</span> </span>
<span id="cb12-36"><a href="r-cheatsheet.html#cb12-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">decision_tree</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-37"><a href="r-cheatsheet.html#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_args</span>(tree_depth, min_n, cost_complexity) <span class="sc">%&gt;%</span> <span class="co"># we could let any of these = tune()</span></span>
<span id="cb12-38"><a href="r-cheatsheet.html#cb12-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;rpart&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-39"><a href="r-cheatsheet.html#cb12-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb12-40"><a href="r-cheatsheet.html#cb12-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-41"><a href="r-cheatsheet.html#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest Model for Regression</span></span>
<span id="cb12-42"><a href="r-cheatsheet.html#cb12-42" aria-hidden="true" tabindex="-1"></a>rf_spec <span class="ot">&lt;-</span> </span>
<span id="cb12-43"><a href="r-cheatsheet.html#cb12-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rand_forest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-44"><a href="r-cheatsheet.html#cb12-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_args</span>(mtry, min_n, trees) <span class="sc">%&gt;%</span> <span class="co"># we could let any of these = tune()</span></span>
<span id="cb12-45"><a href="r-cheatsheet.html#cb12-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;ranger&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-46"><a href="r-cheatsheet.html#cb12-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>)</span></code></pre></div>
</div>
<div id="classification-models" class="section level5 unnumbered">
<h5>Classification Models</h5>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="r-cheatsheet.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic Regression Model</span></span>
<span id="cb13-2"><a href="r-cheatsheet.html#cb13-2" aria-hidden="true" tabindex="-1"></a>logistic_spec <span class="ot">&lt;-</span> </span>
<span id="cb13-3"><a href="r-cheatsheet.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="r-cheatsheet.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;glm&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="r-cheatsheet.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;classification&#39;</span>) </span>
<span id="cb13-6"><a href="r-cheatsheet.html#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="r-cheatsheet.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Lasso Logistic Regression Model</span></span>
<span id="cb13-8"><a href="r-cheatsheet.html#cb13-8" aria-hidden="true" tabindex="-1"></a>logistic_lasso_spec <span class="ot">&lt;-</span> </span>
<span id="cb13-9"><a href="r-cheatsheet.html#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="r-cheatsheet.html#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> lambda) <span class="sc">%&gt;%</span> <span class="co">#we could let penalty = tune()</span></span>
<span id="cb13-11"><a href="r-cheatsheet.html#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;glmnet&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="r-cheatsheet.html#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;classification&#39;</span>) </span>
<span id="cb13-13"><a href="r-cheatsheet.html#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="r-cheatsheet.html#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># K Nearest Neighbors Regression Model</span></span>
<span id="cb13-15"><a href="r-cheatsheet.html#cb13-15" aria-hidden="true" tabindex="-1"></a>knn_spec <span class="ot">&lt;-</span> </span>
<span id="cb13-16"><a href="r-cheatsheet.html#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nearest_neighbor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="r-cheatsheet.html#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_args</span>(<span class="at">neighbors =</span> k) <span class="sc">%&gt;%</span> <span class="co"># we could let neighbors = tune()</span></span>
<span id="cb13-18"><a href="r-cheatsheet.html#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;kknn&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-19"><a href="r-cheatsheet.html#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;classification&#39;</span>) </span>
<span id="cb13-20"><a href="r-cheatsheet.html#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="r-cheatsheet.html#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification Tree Model</span></span>
<span id="cb13-22"><a href="r-cheatsheet.html#cb13-22" aria-hidden="true" tabindex="-1"></a>ct_spec <span class="ot">&lt;-</span> </span>
<span id="cb13-23"><a href="r-cheatsheet.html#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">decision_tree</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-24"><a href="r-cheatsheet.html#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_args</span>(tree_depth, min_n, cost_complexity) <span class="sc">%&gt;%</span></span>
<span id="cb13-25"><a href="r-cheatsheet.html#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;rpart&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-26"><a href="r-cheatsheet.html#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;classification&#39;</span>) </span>
<span id="cb13-27"><a href="r-cheatsheet.html#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="r-cheatsheet.html#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest Model for Classification</span></span>
<span id="cb13-29"><a href="r-cheatsheet.html#cb13-29" aria-hidden="true" tabindex="-1"></a>rf_class_spec <span class="ot">&lt;-</span> </span>
<span id="cb13-30"><a href="r-cheatsheet.html#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rand_forest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-31"><a href="r-cheatsheet.html#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_args</span>(mtry, min_n, trees) <span class="sc">%&gt;%</span> <span class="co"># we could let any of these = tune()</span></span>
<span id="cb13-32"><a href="r-cheatsheet.html#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;ranger&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-33"><a href="r-cheatsheet.html#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;classification&#39;</span>) </span></code></pre></div>
</div>
</div>
</div>
<div id="preprocessing-data" class="section level3 unnumbered">
<h3>Preprocessing Data</h3>
<p>For more information and many examples, see the documentation for the recipes package (part of the tidymodels package): <a href="https://recipes.tidymodels.org/" class="uri">https://recipes.tidymodels.org/</a></p>
<div id="recipes" class="section level4 unnumbered">
<h4>Recipes</h4>
<p>To facilitate transparency, organization, and consistency of process, we create a recipe of the steps taken for preprocessing the data prior to modeling.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="r-cheatsheet.html#cb14-1" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(formula, data) <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="r-cheatsheet.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  step_{FILLIN}() <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="r-cheatsheet.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  step_{FILLIN}() <span class="co"># continue to add preprocessing steps; note that the order matters! </span></span></code></pre></div>
<p>Make sure to include the steps in the same order as they listed below.</p>
<ul>
<li>Row Operations</li>
<li>Imputation</li>
<li>Factor Levels</li>
<li>Univariate Quant. Transformations</li>
<li>Discretization</li>
<li>Dummy Variables</li>
<li>Interactions</li>
<li>Normalization</li>
<li>Multivariate Transformations</li>
<li>Down/Up Sampling (we won’t talk about this very much)</li>
</ul>
<div id="row-operations" class="section level5 unnumbered">
<h5>Row Operations</h5>
<p>The step functions available for row operations are below.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="r-cheatsheet.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step_filter</span>(condition) <span class="co"># use rows that satisfy a condition</span></span>
<span id="cb15-2"><a href="r-cheatsheet.html#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="r-cheatsheet.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">step_sample</span>(size) <span class="co"># use randomly select rows</span></span>
<span id="cb15-4"><a href="r-cheatsheet.html#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="r-cheatsheet.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">step_shuffle</span>(var) <span class="co"># randomly change the order of rows for selected variables (not needed for most circumstances)</span></span>
<span id="cb15-6"><a href="r-cheatsheet.html#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="r-cheatsheet.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">step_slice</span>(index) <span class="co"># use rows with the index (row numbers) provided</span></span>
<span id="cb15-8"><a href="r-cheatsheet.html#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="r-cheatsheet.html#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">step_arrange</span>(var) <span class="co"># sort rows according to the values of selected variables</span></span>
<span id="cb15-10"><a href="r-cheatsheet.html#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="r-cheatsheet.html#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">step_corr</span>() <span class="co"># removes predictors with high correlation with other predictors</span></span>
<span id="cb15-12"><a href="r-cheatsheet.html#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="r-cheatsheet.html#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">step_lincomb</span>() <span class="co"># removes predictors that are linear combinations of others</span></span>
<span id="cb15-14"><a href="r-cheatsheet.html#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="r-cheatsheet.html#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="fu">step_zv</span>() <span class="co"># removes predictors with zero variability</span></span>
<span id="cb15-16"><a href="r-cheatsheet.html#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="r-cheatsheet.html#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="fu">step_nzv</span>() <span class="co"># removes predictors with near zero variability</span></span></code></pre></div>
</div>
<div id="imputation" class="section level5 unnumbered">
<h5>Imputation</h5>
<p>The step functions available for imputing values for missing values are below.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="r-cheatsheet.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step_impute_bag</span>(impute_with) <span class="co"># imputation via bagged trees</span></span>
<span id="cb16-2"><a href="r-cheatsheet.html#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="r-cheatsheet.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">step_impute_knn</span>(impute_with) <span class="co"># imputation via K-nearest neighbors</span></span>
<span id="cb16-4"><a href="r-cheatsheet.html#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="r-cheatsheet.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">step_impute_mode</span>() <span class="co"># imputation of most common value</span></span>
<span id="cb16-6"><a href="r-cheatsheet.html#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="r-cheatsheet.html#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">step_unknown</span>() <span class="co"># assign missing to &quot;unknown&quot; category</span></span></code></pre></div>
</div>
<div id="factor-levels" class="section level5 unnumbered">
<h5>Factor Levels</h5>
<p>The step functions available for changing the levels for factors are below.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="r-cheatsheet.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step_relevel</span>(ref_level) <span class="co"># change reference level of factor </span></span></code></pre></div>
</div>
<div id="univariate-quant.-transformations" class="section level5 unnumbered">
<h5>Univariate Quant. Transformations</h5>
<p>The step functions available for transforming quantitative variables are below.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="r-cheatsheet.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step_BoxCox</span>() <span class="co"># box cox transformation</span></span>
<span id="cb18-2"><a href="r-cheatsheet.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="r-cheatsheet.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">step_log</span>() <span class="co"># log transformation</span></span>
<span id="cb18-4"><a href="r-cheatsheet.html#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="r-cheatsheet.html#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">step_bs</span>() <span class="co"># basis spline</span></span>
<span id="cb18-6"><a href="r-cheatsheet.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="r-cheatsheet.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">step_ns</span>() <span class="co"># natural spline</span></span>
<span id="cb18-8"><a href="r-cheatsheet.html#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="r-cheatsheet.html#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">step_poly</span>() <span class="co"># polynomial transformation</span></span>
<span id="cb18-10"><a href="r-cheatsheet.html#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="r-cheatsheet.html#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="fu">step_mutate</span>() <span class="co"># mutate a variable in the way you specify</span></span></code></pre></div>
</div>
<div id="discretization" class="section level5 unnumbered">
<h5>Discretization</h5>
<p>The step functions available for transforming quantitative variables into categorical variables are below.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="r-cheatsheet.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step_discretize</span>(num_breaks)</span>
<span id="cb19-2"><a href="r-cheatsheet.html#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="r-cheatsheet.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">step_cut</span>(breaks)</span></code></pre></div>
</div>
<div id="dummy-variables" class="section level5 unnumbered">
<h5>Dummy Variables</h5>
<p>The step functions available for transforming categorical variables into quantitative variables (dummy/indicator variables) and dealing with categorical levels are below.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="r-cheatsheet.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step_novel</span>() <span class="co"># create category for new levels in test set</span></span>
<span id="cb20-2"><a href="r-cheatsheet.html#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="r-cheatsheet.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">step_other</span>(threshold) <span class="co"># collapse small categories into an &quot;other&quot; category</span></span>
<span id="cb20-4"><a href="r-cheatsheet.html#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="r-cheatsheet.html#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">step_date</span>(<span class="at">features =</span> <span class="fu">c</span>(<span class="st">&#39;dow&#39;</span>,<span class="st">&#39;month&#39;</span>,<span class="st">&#39;year&#39;</span>)) <span class="co"># create features based on date variables</span></span>
<span id="cb20-6"><a href="r-cheatsheet.html#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="r-cheatsheet.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">step_dummy</span>() <span class="co"># create indicators based on nominal variables</span></span>
<span id="cb20-8"><a href="r-cheatsheet.html#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="r-cheatsheet.html#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">step_regex</span>() <span class="co"># create indicators using regular expressions</span></span></code></pre></div>
</div>
<div id="interactions" class="section level5 unnumbered">
<h5>Interactions</h5>
<p>The step functions available for creating interaction terms are below.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="r-cheatsheet.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step_interact</span>(<span class="sc">~</span> A<span class="sc">:</span>B)</span>
<span id="cb21-2"><a href="r-cheatsheet.html#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="r-cheatsheet.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">starts_with</span>(<span class="st">&quot;CatA&quot;</span>)<span class="sc">:</span><span class="fu">starts_with</span>(<span class="st">&quot;CatB&quot;</span>))</span></code></pre></div>
</div>
<div id="normalization" class="section level5 unnumbered">
<h5>Normalization</h5>
<p>The step functions available for centering, scaling, and standardizing/normalizing are below.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="r-cheatsheet.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step_center</span>() <span class="co"># subtracts mean</span></span>
<span id="cb22-2"><a href="r-cheatsheet.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step_scale</span>() <span class="co"># divides by sd</span></span>
<span id="cb22-3"><a href="r-cheatsheet.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">step_normalize</span>() <span class="co"># both center and scale</span></span></code></pre></div>
</div>
<div id="multivariate-transformations" class="section level5 unnumbered">
<h5>Multivariate Transformations</h5>
<p>The step functions available for combining/transforming many quantitative variables are below.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="r-cheatsheet.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step_pca</span>()</span></code></pre></div>
</div>
</div>
<div id="variable-roles" class="section level4 unnumbered">
<h4>Variable Roles</h4>
<p>In a recipe, each variable has a role. Typical roles are:</p>
<ul>
<li>Outcome</li>
<li>Predictor</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="r-cheatsheet.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use summary to see the roles of the variables</span></span>
<span id="cb24-2"><a href="r-cheatsheet.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">recipe</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb24-3"><a href="r-cheatsheet.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() </span>
<span id="cb24-4"><a href="r-cheatsheet.html#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="r-cheatsheet.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># in the steps of the recipe, you can refer to variables based on their roles</span></span>
<span id="cb24-6"><a href="r-cheatsheet.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">all_predictors</span>()</span>
<span id="cb24-7"><a href="r-cheatsheet.html#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">all_outcomes</span>()</span>
<span id="cb24-8"><a href="r-cheatsheet.html#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="r-cheatsheet.html#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># in the recipe, you can refer to variables based on their type (quantitative: numeric, categorical: nominal)</span></span>
<span id="cb24-10"><a href="r-cheatsheet.html#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">all_numeric</span>()</span>
<span id="cb24-11"><a href="r-cheatsheet.html#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="fu">all_nominal</span>()</span>
<span id="cb24-12"><a href="r-cheatsheet.html#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="r-cheatsheet.html#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># in the recipe, you can refer to variables based on their type and role</span></span>
<span id="cb24-14"><a href="r-cheatsheet.html#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="fu">all_numeric_predictors</span>()</span>
<span id="cb24-15"><a href="r-cheatsheet.html#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">all_nominal_predictors</span>()</span>
<span id="cb24-16"><a href="r-cheatsheet.html#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="r-cheatsheet.html#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co"># roles can help you select groups of variables</span></span>
<span id="cb24-18"><a href="r-cheatsheet.html#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="fu">has_role</span>() </span>
<span id="cb24-19"><a href="r-cheatsheet.html#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="fu">has_type</span>()</span></code></pre></div>
<p>Roles to consider adding if you want to keep variables in the data set but do not want to use them in the model:</p>
<ul>
<li>ID (to exclude from modeling)</li>
<li>Locations</li>
<li>Date/Times</li>
<li>General Categories of Predictors</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="r-cheatsheet.html#cb25-1" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="r-cheatsheet.html#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>() </span>
<span id="cb25-3"><a href="r-cheatsheet.html#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="r-cheatsheet.html#cb25-4" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="r-cheatsheet.html#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_role</span>() <span class="sc">%&gt;%</span> <span class="co"># variables can have multiple roles</span></span>
<span id="cb25-6"><a href="r-cheatsheet.html#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_role</span>() </span></code></pre></div>
</div>
<div id="prep-data" class="section level4 unnumbered">
<h4>Prep Data</h4>
<p>If you aren’t ready to fit the model but want to see the pre-processed data, you can use these functions.</p>
<p><em>Note: The prep and bake steps are done for you when you fit models</em></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="r-cheatsheet.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">recipe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="r-cheatsheet.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>(<span class="at">training =</span> train_data) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="r-cheatsheet.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() <span class="co"># returns preprocessed training data</span></span>
<span id="cb26-4"><a href="r-cheatsheet.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-5"><a href="r-cheatsheet.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">recipe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="r-cheatsheet.html#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>(<span class="at">training =</span> train_data) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="r-cheatsheet.html#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bake</span>(<span class="at">new_data =</span> test_data) <span class="co"># returns preprocessed test data using values from train data</span></span></code></pre></div>
</div>
</div>
<div id="data-subsets" class="section level3 unnumbered">
<h3>Data Subsets</h3>
<p>For more information and many examples, see the documentation for the rsample package (part of the tidymodels package): <a href="https://rsample.tidymodels.org/" class="uri">https://rsample.tidymodels.org/</a></p>
<div id="random-splits" class="section level4 unnumbered">
<h4>Random Splits</h4>
<p>To randomly split your data set into a training and test set, use <code>initial_split()</code>. You can change <code>prop</code> to 0.8 for a training set equal to 80% of the rows. You can specify a variable for the <code>strata</code> argument to make the random sampling to be conducted within the stratification variable; this can help ensure that the number of data points in the training data is equivalent to the proportions in the original data set.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="r-cheatsheet.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># to reproduce your random split, set a seed  - pick an integer</span></span>
<span id="cb27-2"><a href="r-cheatsheet.html#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="r-cheatsheet.html#cb27-3" aria-hidden="true" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(data, <span class="at">prop =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="co"># saves minimal information about the split (which rows are in the training set and which are in the testing set)</span></span>
<span id="cb27-4"><a href="r-cheatsheet.html#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="r-cheatsheet.html#cb27-5" aria-hidden="true" tabindex="-1"></a>data_train <span class="ot">&lt;-</span> <span class="fu">training</span>(data_split)</span>
<span id="cb27-6"><a href="r-cheatsheet.html#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="r-cheatsheet.html#cb27-7" aria-hidden="true" tabindex="-1"></a>data_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(data_split)</span></code></pre></div>
</div>
<div id="cross-validationresamples" class="section level4 unnumbered">
<h4>Cross-Validation/Resamples</h4>
<p>To complete cross-validation, use <code>vfold_cv()</code>. This function saves information about the folds (which rows are in which fold) and which rows should be used for training and testing for each iteration.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="r-cheatsheet.html#cb28-1" aria-hidden="true" tabindex="-1"></a>data_cv <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(data, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb28-2"><a href="r-cheatsheet.html#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="r-cheatsheet.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># In practice, you don&#39;t need to use the following functions but it is useful to know what is going on behind the scenes</span></span>
<span id="cb28-4"><a href="r-cheatsheet.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">training</span>(data_cv<span class="sc">$</span>splits[[<span class="dv">1</span>]]) <span class="co"># pulls training data for the 1st split (1st fold is testing set)</span></span>
<span id="cb28-5"><a href="r-cheatsheet.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">testing</span>(data_cv<span class="sc">$</span>splits[[<span class="dv">1</span>]]) <span class="co"># pulls testing data for the 1st split (1st fold is testing set)</span></span></code></pre></div>
</div>
</div>
<div id="workflows" class="section level3 unnumbered">
<h3>Workflows</h3>
<p>A machine learning workflow (the “black box”) = model specification + preprocessing recipe/formula</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="r-cheatsheet.html#cb29-1" aria-hidden="true" tabindex="-1"></a>model_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="r-cheatsheet.html#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rec) <span class="sc">%&gt;%</span> <span class="co"># add_formula(formula) if no recipe</span></span>
<span id="cb29-3"><a href="r-cheatsheet.html#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(mod_spec)</span>
<span id="cb29-4"><a href="r-cheatsheet.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-5"><a href="r-cheatsheet.html#cb29-5" aria-hidden="true" tabindex="-1"></a>model_wf <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="r-cheatsheet.html#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_recipe</span>(rec_new)</span>
<span id="cb29-7"><a href="r-cheatsheet.html#cb29-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-8"><a href="r-cheatsheet.html#cb29-8" aria-hidden="true" tabindex="-1"></a>model_wf <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="r-cheatsheet.html#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_formula</span>(formula_new)</span>
<span id="cb29-10"><a href="r-cheatsheet.html#cb29-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-11"><a href="r-cheatsheet.html#cb29-11" aria-hidden="true" tabindex="-1"></a>model_wf <span class="sc">%&gt;%</span></span>
<span id="cb29-12"><a href="r-cheatsheet.html#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_model</span>(model_spec_new)</span></code></pre></div>
</div>
<div id="fit-model" class="section level3 unnumbered">
<h3>Fit Model</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="r-cheatsheet.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model to given training data</span></span>
<span id="cb30-2"><a href="r-cheatsheet.html#cb30-2" aria-hidden="true" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="fu">fit</span>(model_spec, formula, data_train) <span class="co"># fit model using a formula (no recipe) and model_spec</span></span>
<span id="cb30-3"><a href="r-cheatsheet.html#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="r-cheatsheet.html#cb30-4" aria-hidden="true" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="fu">fit</span>(model_wf, data_train) <span class="co"># fit model using a workflow</span></span>
<span id="cb30-5"><a href="r-cheatsheet.html#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="r-cheatsheet.html#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model using CV</span></span>
<span id="cb30-7"><a href="r-cheatsheet.html#cb30-7" aria-hidden="true" tabindex="-1"></a>fit_model_cv <span class="ot">&lt;-</span> <span class="fu">fit_resamples</span>(model_wf, <span class="co"># fit and evaluate model with CV</span></span>
<span id="cb30-8"><a href="r-cheatsheet.html#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> data_cv, </span>
<span id="cb30-9"><a href="r-cheatsheet.html#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>()</span>
<span id="cb30-10"><a href="r-cheatsheet.html#cb30-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># from tune package</span></span>
<span id="cb30-11"><a href="r-cheatsheet.html#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="r-cheatsheet.html#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model on one training and evaluate on one test data</span></span>
<span id="cb30-13"><a href="r-cheatsheet.html#cb30-13" aria-hidden="true" tabindex="-1"></a>fit_model_traintest <span class="ot">&lt;-</span> <span class="fu">last_fit</span>(model_wf, <span class="co"># fit model on training and evaluate model on test data</span></span>
<span id="cb30-14"><a href="r-cheatsheet.html#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">split =</span> data_split,</span>
<span id="cb30-15"><a href="r-cheatsheet.html#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>()</span>
<span id="cb30-16"><a href="r-cheatsheet.html#cb30-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># from tune package</span></span></code></pre></div>
</div>
<div id="evaluate-model-metrics" class="section level3 unnumbered">
<h3>Evaluate Model: Metrics</h3>
<p>For documentation and examples about metrics, see the yardstick package, <a href="https://yardstick.tidymodels.org/index.html" class="uri">https://yardstick.tidymodels.org/index.html</a>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="r-cheatsheet.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">metric_set</span>(rmse, rsq, mae) <span class="co"># typical regression metrics</span></span>
<span id="cb31-2"><a href="r-cheatsheet.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="r-cheatsheet.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metric_set</span>(sens, spec, accuracy, roc_auc) <span class="co"># typical classification metrics</span></span></code></pre></div>
<p>For documentation and examples about collecting metrics from train/testing or cross validation, see the workflowsets package, <a href="https://workflowsets.tidymodels.org/" class="uri">https://workflowsets.tidymodels.org/</a></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="r-cheatsheet.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using one training and testing split</span></span>
<span id="cb32-2"><a href="r-cheatsheet.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">last_fit</span>(model_wf, </span>
<span id="cb32-3"><a href="r-cheatsheet.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">split =</span> data_split, </span>
<span id="cb32-4"><a href="r-cheatsheet.html#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, rsq, mae)</span>
<span id="cb32-5"><a href="r-cheatsheet.html#cb32-5" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="r-cheatsheet.html#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span>
<span id="cb32-7"><a href="r-cheatsheet.html#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="r-cheatsheet.html#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Using CV </span></span>
<span id="cb32-9"><a href="r-cheatsheet.html#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">fit_resamples</span>(model_wf, </span>
<span id="cb32-10"><a href="r-cheatsheet.html#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> data_cv, </span>
<span id="cb32-11"><a href="r-cheatsheet.html#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, rsq, mae)</span>
<span id="cb32-12"><a href="r-cheatsheet.html#cb32-12" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span></span>
<span id="cb32-13"><a href="r-cheatsheet.html#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>(<span class="at">summarize =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="tune-model-choosing-tuning-parameters" class="section level3 unnumbered">
<h3>Tune Model: Choosing tuning parameters</h3>
<p>For documentation and examples about tuning a model by selecting tuning parameters, see the tune package, <a href="https://tune.tidymodels.org/" class="uri">https://tune.tidymodels.org/</a></p>
<p>Use <code>tune()</code> for tuning parameters in model and recipe and <code>tune_grid()</code> to fit models with an array of values for the tuning parameters.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="r-cheatsheet.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regularized Regression (LASSO, Ridge)</span></span>
<span id="cb33-2"><a href="r-cheatsheet.html#cb33-2" aria-hidden="true" tabindex="-1"></a>lm_lasso_spec_tune <span class="ot">&lt;-</span> lm_lasso_spec <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="r-cheatsheet.html#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> <span class="fu">tune</span>(<span class="st">&#39;lambda&#39;</span>))</span>
<span id="cb33-4"><a href="r-cheatsheet.html#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="r-cheatsheet.html#cb33-5" aria-hidden="true" tabindex="-1"></a>lm_ridge_spec_tune <span class="ot">&lt;-</span> lm_ridge_spec <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="r-cheatsheet.html#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">0</span>, <span class="at">penalty =</span> <span class="fu">tune</span>(<span class="st">&#39;lambda&#39;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="r-cheatsheet.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of neighbors in KNN</span></span>
<span id="cb34-2"><a href="r-cheatsheet.html#cb34-2" aria-hidden="true" tabindex="-1"></a>knn_spec_tune <span class="ot">&lt;-</span> knn_spec <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="r-cheatsheet.html#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_args</span>(<span class="at">neighbors =</span> <span class="fu">tune</span>(<span class="st">&#39;k&#39;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="r-cheatsheet.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision Trees</span></span>
<span id="cb35-2"><a href="r-cheatsheet.html#cb35-2" aria-hidden="true" tabindex="-1"></a>rt_spec_tune <span class="ot">&lt;-</span> rt_spec <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="r-cheatsheet.html#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_args</span>(<span class="at">cost_complexity =</span> <span class="fu">tune</span>(<span class="st">&#39;cost&#39;</span>), <span class="at">min_n =</span> <span class="fu">tune</span>(<span class="st">&#39;n&#39;</span>))</span>
<span id="cb35-4"><a href="r-cheatsheet.html#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="r-cheatsheet.html#cb35-5" aria-hidden="true" tabindex="-1"></a>ct_spec_tune <span class="ot">&lt;-</span> ct_spec <span class="sc">%&gt;%</span> </span>
<span id="cb35-6"><a href="r-cheatsheet.html#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_args</span>(<span class="at">cost_complexity =</span> <span class="fu">tune</span>(<span class="st">&#39;cost&#39;</span>), <span class="at">min_n =</span> <span class="fu">tune</span>(<span class="st">&#39;n&#39;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="r-cheatsheet.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of Components in PCA</span></span>
<span id="cb36-2"><a href="r-cheatsheet.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">recipe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="r-cheatsheet.html#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_pca</span>(<span class="at">num_comp =</span> <span class="fu">tune</span>(<span class="st">&#39;n&#39;</span>))</span></code></pre></div>
<p>Once you’ve included tune() as the input for the parameter in the model or recipe, you need to fit the model for a variety of values. You may provide a grid of values or you can let the function create a grid of a specified number of values.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="r-cheatsheet.html#cb37-1" aria-hidden="true" tabindex="-1"></a>tune_results <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(model_wf,</span>
<span id="cb37-2"><a href="r-cheatsheet.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> data_cv,</span>
<span id="cb37-3"><a href="r-cheatsheet.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> <span class="dv">10</span>, <span class="co">#creates grid of 10 values</span></span>
<span id="cb37-4"><a href="r-cheatsheet.html#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>())</span>
<span id="cb37-5"><a href="r-cheatsheet.html#cb37-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-6"><a href="r-cheatsheet.html#cb37-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-7"><a href="r-cheatsheet.html#cb37-7" aria-hidden="true" tabindex="-1"></a>tune_results<span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(model_wf,</span>
<span id="cb37-8"><a href="r-cheatsheet.html#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> data_cv,</span>
<span id="cb37-9"><a href="r-cheatsheet.html#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> <span class="fu">expand_grid</span>(<span class="at">k =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="at">by =</span> <span class="dv">1</span>)), <span class="co">#you provide grid, use name in tune() for variable name</span></span>
<span id="cb37-10"><a href="r-cheatsheet.html#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>())  </span>
<span id="cb37-11"><a href="r-cheatsheet.html#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="r-cheatsheet.html#cb37-12" aria-hidden="true" tabindex="-1"></a>tune_results <span class="sc">%&gt;%</span> <span class="fu">show_best</span>()</span>
<span id="cb37-13"><a href="r-cheatsheet.html#cb37-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-14"><a href="r-cheatsheet.html#cb37-14" aria-hidden="true" tabindex="-1"></a>tune_results <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span>
<span id="cb37-15"><a href="r-cheatsheet.html#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="r-cheatsheet.html#cb37-16" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">select_best</span>(tune_results, metric) <span class="co"># or select_by_one_std_err(tune_results, metric, desc(penalty))</span></span>
<span id="cb37-17"><a href="r-cheatsheet.html#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="r-cheatsheet.html#cb37-18" aria-hidden="true" tabindex="-1"></a>final_model_wf <span class="ot">&lt;-</span> <span class="fu">finalize_workflow</span>(model_wf, final_model)</span></code></pre></div>
</div>
<div id="use-final-model-predictions" class="section level3 unnumbered">
<h3>Use Final Model: Predictions</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="r-cheatsheet.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit final model on training data and then predict for any new data set</span></span>
<span id="cb38-2"><a href="r-cheatsheet.html#cb38-2" aria-hidden="true" tabindex="-1"></a>final_model_wf <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="r-cheatsheet.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> data_train) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="r-cheatsheet.html#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> data_test) <span class="co"># get .pred only</span></span>
<span id="cb38-5"><a href="r-cheatsheet.html#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="r-cheatsheet.html#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit final model on training data and then predict for test set</span></span>
<span id="cb38-7"><a href="r-cheatsheet.html#cb38-7" aria-hidden="true" tabindex="-1"></a>final_model_wf <span class="sc">%&gt;%</span> </span>
<span id="cb38-8"><a href="r-cheatsheet.html#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">last_fit</span>( </span>
<span id="cb38-9"><a href="r-cheatsheet.html#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">split =</span> data_split, </span>
<span id="cb38-10"><a href="r-cheatsheet.html#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, rsq, mae)</span>
<span id="cb38-11"><a href="r-cheatsheet.html#cb38-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-12"><a href="r-cheatsheet.html#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_predictions</span>() <span class="co"># get .pred and true values in test set</span></span></code></pre></div>
</div>
<div id="extraction" class="section level3 unnumbered">
<h3>Extraction</h3>
<p>For some models (LASSO, decision trees), you’ll want to pull out the original fit object to make visualizations.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="r-cheatsheet.html#cb39-1" aria-hidden="true" tabindex="-1"></a>fit_model <span class="sc">%&gt;%</span> <span class="fu">extract_fit_engine</span>() <span class="co"># gives you the original fit object by the engine (useful for specific purposes)</span></span>
<span id="cb39-2"><a href="r-cheatsheet.html#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="r-cheatsheet.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pluck</span>(list, <span class="st">&#39;fit&#39;</span>) <span class="co"># gives you the element in the list associated with the name &#39;fit&#39;</span></span></code></pre></div>
</div>
<div id="variable-importance" class="section level3 unnumbered">
<h3>Variable Importance</h3>
<div id="model-agnostic-importance---permutation-approach" class="section level4 unnumbered">
<h4>Model Agnostic Importance - Permutation Approach</h4>
<p>Permutation technique - Train model - Evaluate model</p>
<p>For each variable,</p>
<ol style="list-style-type: decimal">
<li>Randomly shuffle the variable and reevaluate model</li>
<li>Compare the original model evaluation metric to the value when the variable is reshuffled</li>
</ol>
<p>Reshuffling the values of a variable breaks or removes any predictive relationships that may exist with that variable and the outcome variable. So if a variable is highly predictive of the outcome, there should be a large change in the model evaluation metric when it is “removed” through reshuffling.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="r-cheatsheet.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb40-2"><a href="r-cheatsheet.html#cb40-2" aria-hidden="true" tabindex="-1"></a>conflicted<span class="sc">::</span><span class="fu">conflict_prefer</span>(<span class="st">&quot;vi&quot;</span>, <span class="st">&quot;vip&quot;</span>)</span>
<span id="cb40-3"><a href="r-cheatsheet.html#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="r-cheatsheet.html#cb40-4" aria-hidden="true" tabindex="-1"></a>train_prep <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> <span class="fu">prep</span>() <span class="sc">%&gt;%</span> <span class="fu">juice</span>() <span class="co"># Pre-process the training data</span></span>
<span id="cb40-5"><a href="r-cheatsheet.html#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="r-cheatsheet.html#cb40-6" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> fit_model <span class="sc">%&gt;%</span> <span class="fu">extract_fit_engine</span>()  <span class="co"># Pull the fit model</span></span>
<span id="cb40-7"><a href="r-cheatsheet.html#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="r-cheatsheet.html#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Variable Importance using Permutation approach</span></span>
<span id="cb40-9"><a href="r-cheatsheet.html#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">vi</span>(mod, <span class="at">method =</span> <span class="st">&#39;permute&#39;</span>, <span class="at">target =</span> <span class="st">&#39;outcomename&#39;</span>, <span class="at">metric =</span> <span class="st">&#39;metricname&#39;</span>, <span class="at">train =</span> train_prep, <span class="at">pred_wrapper =</span> predict)</span>
<span id="cb40-10"><a href="r-cheatsheet.html#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="r-cheatsheet.html#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># use vip instead of vi for plot</span></span></code></pre></div>
</div>
<div id="model-specific-importance" class="section level4 unnumbered">
<h4>Model Specific Importance</h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="r-cheatsheet.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## LASSO Var Importance</span></span>
<span id="cb41-2"><a href="r-cheatsheet.html#cb41-2" aria-hidden="true" tabindex="-1"></a>glmnet_output <span class="ot">&lt;-</span> final_fit_se <span class="sc">%&gt;%</span> <span class="fu">extract_fit_engine</span>()</span>
<span id="cb41-3"><a href="r-cheatsheet.html#cb41-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-4"><a href="r-cheatsheet.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a boolean matrix (predictors x lambdas) of variable exclusion</span></span>
<span id="cb41-5"><a href="r-cheatsheet.html#cb41-5" aria-hidden="true" tabindex="-1"></a>bool_predictor_exclude <span class="ot">&lt;-</span> glmnet_output<span class="sc">$</span>beta<span class="sc">==</span><span class="dv">0</span></span>
<span id="cb41-6"><a href="r-cheatsheet.html#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="r-cheatsheet.html#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over each variable</span></span>
<span id="cb41-8"><a href="r-cheatsheet.html#cb41-8" aria-hidden="true" tabindex="-1"></a>var_imp <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(bool_predictor_exclude)), <span class="cf">function</span>(row) {</span>
<span id="cb41-9"><a href="r-cheatsheet.html#cb41-9" aria-hidden="true" tabindex="-1"></a>    this_coeff_path <span class="ot">&lt;-</span> bool_predictor_exclude[row,]</span>
<span id="cb41-10"><a href="r-cheatsheet.html#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">sum</span>(this_coeff_path) <span class="sc">==</span> <span class="fu">ncol</span>(bool_predictor_exclude)){ <span class="fu">return</span>(<span class="dv">0</span>)}<span class="cf">else</span>{</span>
<span id="cb41-11"><a href="r-cheatsheet.html#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">ncol</span>(bool_predictor_exclude) <span class="sc">-</span> <span class="fu">which.min</span>(this_coeff_path) <span class="sc">+</span> <span class="dv">1</span>)}</span>
<span id="cb41-12"><a href="r-cheatsheet.html#cb41-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb41-13"><a href="r-cheatsheet.html#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="r-cheatsheet.html#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataset of this information and sort</span></span>
<span id="cb41-15"><a href="r-cheatsheet.html#cb41-15" aria-hidden="true" tabindex="-1"></a>var_imp_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb41-16"><a href="r-cheatsheet.html#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">var_name =</span> <span class="fu">rownames</span>(bool_predictor_exclude),</span>
<span id="cb41-17"><a href="r-cheatsheet.html#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">var_imp =</span> var_imp</span>
<span id="cb41-18"><a href="r-cheatsheet.html#cb41-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-19"><a href="r-cheatsheet.html#cb41-19" aria-hidden="true" tabindex="-1"></a>var_imp_data <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(var_imp))</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="r-cheatsheet.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Tree and Forest Var Importance</span></span>
<span id="cb42-2"><a href="r-cheatsheet.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb42-3"><a href="r-cheatsheet.html#cb42-3" aria-hidden="true" tabindex="-1"></a>conflicted<span class="sc">::</span><span class="fu">conflict_prefer</span>(<span class="st">&quot;vi&quot;</span>, <span class="st">&quot;vip&quot;</span>)</span>
<span id="cb42-4"><a href="r-cheatsheet.html#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="r-cheatsheet.html#cb42-5" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> fit_tree_model <span class="sc">%&gt;%</span> <span class="fu">extract_fit_engine</span>() <span class="co"># fit_tree_model would come from fitting a decision_tree() model</span></span>
<span id="cb42-6"><a href="r-cheatsheet.html#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">vi</span>(tree)</span>
<span id="cb42-7"><a href="r-cheatsheet.html#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="r-cheatsheet.html#cb42-8" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">&lt;-</span> fit_rf_model <span class="sc">%&gt;%</span> <span class="fu">extract_fit_engine</span>() <span class="co"># fit_rf_model would come from fitting a rand_forest() model</span></span>
<span id="cb42-9"><a href="r-cheatsheet.html#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">vi</span>(rf)</span>
<span id="cb42-10"><a href="r-cheatsheet.html#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="r-cheatsheet.html#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># use vip instead of vi for plot</span></span></code></pre></div>
</div>
</div>
<div id="comparing-models-workflow-sets" class="section level3 unnumbered">
<h3>Comparing Models: Workflow Sets</h3>
<p>For documentation and examples about comparing models, see the workflowsets package, <a href="https://workflowsets.tidymodels.org/" class="uri">https://workflowsets.tidymodels.org/</a></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="r-cheatsheet.html#cb43-1" aria-hidden="true" tabindex="-1"></a>wf_set <span class="ot">&lt;-</span> <span class="fu">workflow_set</span>(</span>
<span id="cb43-2"><a href="r-cheatsheet.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">preproc =</span> <span class="fu">list</span>(<span class="at">rec1 =</span> recipe1, <span class="at">rec2 =</span> recipe2, <span class="at">rec3 =</span> recipe3),</span>
<span id="cb43-3"><a href="r-cheatsheet.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">models =</span> <span class="fu">list</span>(<span class="at">mod1 =</span> model_spec1, <span class="at">mod2 =</span> model_spec2, <span class="at">mod3 =</span> model_spec3),</span>
<span id="cb43-4"><a href="r-cheatsheet.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cross =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="r-cheatsheet.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow_map</span>(</span>
<span id="cb43-6"><a href="r-cheatsheet.html#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fit_resamples&quot;</span>, </span>
<span id="cb43-7"><a href="r-cheatsheet.html#cb43-7" aria-hidden="true" tabindex="-1"></a>    resamples,</span>
<span id="cb43-8"><a href="r-cheatsheet.html#cb43-8" aria-hidden="true" tabindex="-1"></a>    metrics) </span>
<span id="cb43-9"><a href="r-cheatsheet.html#cb43-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-10"><a href="r-cheatsheet.html#cb43-10" aria-hidden="true" tabindex="-1"></a>wf_set <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span>
<span id="cb43-11"><a href="r-cheatsheet.html#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="r-cheatsheet.html#cb43-12" aria-hidden="true" tabindex="-1"></a>wf_set <span class="sc">%&gt;%</span> <span class="fu">rank_results</span>(rank_metric)</span></code></pre></div>
</div>
</div>
<div id="visualizing-fit-models" class="section level2 unnumbered">
<h2>Visualizing Fit Models</h2>
<div id="visualize-coefficients" class="section level3 unnumbered">
<h3>Visualize Coefficients</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="r-cheatsheet.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For Linear Regression</span></span>
<span id="cb44-2"><a href="r-cheatsheet.html#cb44-2" aria-hidden="true" tabindex="-1"></a>fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="r-cheatsheet.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="r-cheatsheet.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="r-cheatsheet.html#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lower =</span> estimate <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>std.error, <span class="at">upper =</span> estimate <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>std.error) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="r-cheatsheet.html#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-7"><a href="r-cheatsheet.html#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="r-cheatsheet.html#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>estimate, <span class="at">y=</span>term)) <span class="sc">+</span></span>
<span id="cb44-9"><a href="r-cheatsheet.html#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y=</span>term, <span class="at">yend=</span>term, <span class="at">x=</span>lower, <span class="at">xend=</span>upper), <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">angle=</span><span class="dv">90</span>, <span class="at">ends=</span><span class="st">&#39;both&#39;</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&#39;cm&#39;</span>))) <span class="sc">+</span></span>
<span id="cb44-10"><a href="r-cheatsheet.html#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Coefficient estimate (95% CI)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Feature&#39;</span>) <span class="sc">+</span> </span>
<span id="cb44-11"><a href="r-cheatsheet.html#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb44-12"><a href="r-cheatsheet.html#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="r-cheatsheet.html#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="r-cheatsheet.html#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co"># For Logistic Regression</span></span>
<span id="cb44-15"><a href="r-cheatsheet.html#cb44-15" aria-hidden="true" tabindex="-1"></a>fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb44-16"><a href="r-cheatsheet.html#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-17"><a href="r-cheatsheet.html#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-18"><a href="r-cheatsheet.html#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">OR.conf.low =</span> <span class="fu">exp</span>(estimate <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>std.error), <span class="at">OR.conf.high =</span> <span class="fu">exp</span>(estimate <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>std.error)) <span class="sc">%&gt;%</span> <span class="co"># do this first</span></span>
<span id="cb44-19"><a href="r-cheatsheet.html#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">OR =</span> <span class="fu">exp</span>(estimate)) <span class="sc">%&gt;%</span></span>
<span id="cb44-20"><a href="r-cheatsheet.html#cb44-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-21"><a href="r-cheatsheet.html#cb44-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb44-22"><a href="r-cheatsheet.html#cb44-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>OR, <span class="at">y=</span>term)) <span class="sc">+</span></span>
<span id="cb44-23"><a href="r-cheatsheet.html#cb44-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y=</span>term, <span class="at">yend=</span>term, <span class="at">x=</span>OR.conf.lower, <span class="at">xend=</span>OR.conf.upper), <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">angle=</span><span class="dv">90</span>, <span class="at">ends=</span><span class="st">&#39;both&#39;</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&#39;cm&#39;</span>))) <span class="sc">+</span></span>
<span id="cb44-24"><a href="r-cheatsheet.html#cb44-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Coefficient estimate (95% CI)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Feature&#39;</span>) <span class="sc">+</span> </span>
<span id="cb44-25"><a href="r-cheatsheet.html#cb44-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div id="visualize-effects" class="section level3 unnumbered">
<h3>Visualize Effects</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="r-cheatsheet.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear Regression</span></span>
<span id="cb45-2"><a href="r-cheatsheet.html#cb45-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="r-cheatsheet.html#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="r-cheatsheet.html#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(outcome,id), <span class="at">names_to =</span> <span class="st">&#39;key&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="r-cheatsheet.html#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(</span>
<span id="cb45-6"><a href="r-cheatsheet.html#cb45-6" aria-hidden="true" tabindex="-1"></a>    (lm_fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb45-7"><a href="r-cheatsheet.html#cb45-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="r-cheatsheet.html#cb45-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-9"><a href="r-cheatsheet.html#cb45-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(term, estimate)),</span>
<span id="cb45-10"><a href="r-cheatsheet.html#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;key&#39;</span><span class="ot">=</span><span class="st">&#39;term&#39;</span>)</span>
<span id="cb45-11"><a href="r-cheatsheet.html#cb45-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-12"><a href="r-cheatsheet.html#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effect =</span> value <span class="sc">*</span> estimate) <span class="sc">%&gt;%</span></span>
<span id="cb45-13"><a href="r-cheatsheet.html#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> effect, <span class="at">y =</span> key)) <span class="sc">+</span></span>
<span id="cb45-14"><a href="r-cheatsheet.html#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb45-15"><a href="r-cheatsheet.html#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb45-16"><a href="r-cheatsheet.html#cb45-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Effect&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Feature&#39;</span>) <span class="sc">+</span> </span>
<span id="cb45-17"><a href="r-cheatsheet.html#cb45-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb45-18"><a href="r-cheatsheet.html#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="r-cheatsheet.html#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="r-cheatsheet.html#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic Regression</span></span>
<span id="cb45-21"><a href="r-cheatsheet.html#cb45-21" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb45-22"><a href="r-cheatsheet.html#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb45-23"><a href="r-cheatsheet.html#cb45-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(outcome,id), <span class="at">names_to =</span> <span class="st">&#39;key&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-24"><a href="r-cheatsheet.html#cb45-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(</span>
<span id="cb45-25"><a href="r-cheatsheet.html#cb45-25" aria-hidden="true" tabindex="-1"></a>    (glm_fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb45-26"><a href="r-cheatsheet.html#cb45-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-27"><a href="r-cheatsheet.html#cb45-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-28"><a href="r-cheatsheet.html#cb45-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(term, estimate)),</span>
<span id="cb45-29"><a href="r-cheatsheet.html#cb45-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;key&#39;</span><span class="ot">=</span><span class="st">&#39;term&#39;</span>)</span>
<span id="cb45-30"><a href="r-cheatsheet.html#cb45-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-31"><a href="r-cheatsheet.html#cb45-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effect =</span> value <span class="sc">*</span> estimate) <span class="sc">%&gt;%</span></span>
<span id="cb45-32"><a href="r-cheatsheet.html#cb45-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> effect, <span class="at">y =</span> key)) <span class="sc">+</span></span>
<span id="cb45-33"><a href="r-cheatsheet.html#cb45-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb45-34"><a href="r-cheatsheet.html#cb45-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb45-35"><a href="r-cheatsheet.html#cb45-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Effect (Log Odds units)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Feature&#39;</span>) <span class="sc">+</span> </span>
<span id="cb45-36"><a href="r-cheatsheet.html#cb45-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div id="visualize-residuals" class="section level3 unnumbered">
<h3>Visualize Residuals</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="r-cheatsheet.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For Any Regression Model</span></span>
<span id="cb46-2"><a href="r-cheatsheet.html#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="r-cheatsheet.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Predicted vs. Residual</span></span>
<span id="cb46-4"><a href="r-cheatsheet.html#cb46-4" aria-hidden="true" tabindex="-1"></a>fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb46-5"><a href="r-cheatsheet.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> data_train) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="r-cheatsheet.html#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_train) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="r-cheatsheet.html#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resid =</span> outcome <span class="sc">-</span> .pred) <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="r-cheatsheet.html#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred, <span class="at">y =</span> resid)) <span class="sc">+</span> </span>
<span id="cb46-9"><a href="r-cheatsheet.html#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-10"><a href="r-cheatsheet.html#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb46-11"><a href="r-cheatsheet.html#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb46-12"><a href="r-cheatsheet.html#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="r-cheatsheet.html#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="r-cheatsheet.html#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Variable vs. Residual</span></span>
<span id="cb46-15"><a href="r-cheatsheet.html#cb46-15" aria-hidden="true" tabindex="-1"></a>fit_model <span class="sc">%&gt;%</span> </span>
<span id="cb46-16"><a href="r-cheatsheet.html#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> data_train) <span class="sc">%&gt;%</span></span>
<span id="cb46-17"><a href="r-cheatsheet.html#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_train) <span class="sc">%&gt;%</span></span>
<span id="cb46-18"><a href="r-cheatsheet.html#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resid =</span> outcome <span class="sc">-</span> .pred) <span class="sc">%&gt;%</span></span>
<span id="cb46-19"><a href="r-cheatsheet.html#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> var, <span class="at">y =</span> resid)) <span class="sc">+</span> </span>
<span id="cb46-20"><a href="r-cheatsheet.html#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-21"><a href="r-cheatsheet.html#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb46-22"><a href="r-cheatsheet.html#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div id="visualize-predictions" class="section level3 unnumbered">
<h3>Visualize Predictions</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="r-cheatsheet.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For Any Regression Model</span></span>
<span id="cb47-2"><a href="r-cheatsheet.html#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="r-cheatsheet.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data_grid (fixing all other variables at some value, sequence of values for the variable of interest)</span></span>
<span id="cb47-4"><a href="r-cheatsheet.html#cb47-4" aria-hidden="true" tabindex="-1"></a>data_grid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> value1, <span class="at">x2 =</span> value2, <span class="at">x3 =</span> value3, <span class="at">x4 =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="at">by =</span> <span class="dv">1</span>)) <span class="co">#example where x4 is variable of interest</span></span>
<span id="cb47-5"><a href="r-cheatsheet.html#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="r-cheatsheet.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Predicted Values for test values in data_grid</span></span>
<span id="cb47-7"><a href="r-cheatsheet.html#cb47-7" aria-hidden="true" tabindex="-1"></a>predicted_lines <span class="ot">&lt;-</span> data_grid <span class="sc">%&gt;%</span> </span>
<span id="cb47-8"><a href="r-cheatsheet.html#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb47-9"><a href="r-cheatsheet.html#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(fit_model, <span class="at">new_data =</span> data_grid),</span>
<span id="cb47-10"><a href="r-cheatsheet.html#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(fit_model, <span class="at">new_data =</span> data_grid, <span class="at">type=</span><span class="st">&#39;conf_int&#39;</span>)</span>
<span id="cb47-11"><a href="r-cheatsheet.html#cb47-11" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb47-12"><a href="r-cheatsheet.html#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="r-cheatsheet.html#cb47-13" aria-hidden="true" tabindex="-1"></a>train_data <span class="sc">%&gt;%</span></span>
<span id="cb47-14"><a href="r-cheatsheet.html#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x4, <span class="at">y =</span> outcome)) <span class="sc">+</span> </span>
<span id="cb47-15"><a href="r-cheatsheet.html#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb47-16"><a href="r-cheatsheet.html#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .pred, <span class="at">x =</span> x4), <span class="at">data =</span> predicted_lines) <span class="sc">+</span></span>
<span id="cb47-17"><a href="r-cheatsheet.html#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .pred_lower, <span class="at">x =</span> x4), <span class="at">data =</span> predicted_lines) <span class="sc">+</span></span>
<span id="cb47-18"><a href="r-cheatsheet.html#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .pred_upper, <span class="at">x =</span> x4), <span class="at">data =</span> predicted_lines) <span class="sc">+</span></span>
<span id="cb47-19"><a href="r-cheatsheet.html#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div id="visualize-lasso-coefficients" class="section level3" number="0.0.1">
<h3><span class="header-section-number">0.0.1</span> Visualize LASSO Coefficients</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="r-cheatsheet.html#cb48-1" aria-hidden="true" tabindex="-1"></a>glmnet_output <span class="ot">&lt;-</span> final_fit_se <span class="sc">%&gt;%</span> <span class="fu">extract_fit_engine</span>() <span class="co"># get the original glmnet output</span></span>
<span id="cb48-2"><a href="r-cheatsheet.html#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="r-cheatsheet.html#cb48-3" aria-hidden="true" tabindex="-1"></a>lambdas <span class="ot">&lt;-</span> glmnet_output<span class="sc">$</span>lambda</span>
<span id="cb48-4"><a href="r-cheatsheet.html#cb48-4" aria-hidden="true" tabindex="-1"></a>coefs_lambdas <span class="ot">&lt;-</span> </span>
<span id="cb48-5"><a href="r-cheatsheet.html#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coefficients</span>(glmnet_output, <span class="at">s =</span> lambdas )  <span class="sc">%&gt;%</span> </span>
<span id="cb48-6"><a href="r-cheatsheet.html#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb48-7"><a href="r-cheatsheet.html#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-8"><a href="r-cheatsheet.html#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-9"><a href="r-cheatsheet.html#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lambda =</span> lambdas ) <span class="sc">%&gt;%</span> </span>
<span id="cb48-10"><a href="r-cheatsheet.html#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lambda, <span class="fu">everything</span>(), <span class="sc">-</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-11"><a href="r-cheatsheet.html#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>lambda, </span>
<span id="cb48-12"><a href="r-cheatsheet.html#cb48-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;term&quot;</span>, </span>
<span id="cb48-13"><a href="r-cheatsheet.html#cb48-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;coef&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-14"><a href="r-cheatsheet.html#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">var =</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(stringr<span class="sc">::</span><span class="fu">str_split</span>(term,<span class="st">&quot;_&quot;</span>),<span class="sc">~</span>.[<span class="dv">1</span>]))</span>
<span id="cb48-15"><a href="r-cheatsheet.html#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="r-cheatsheet.html#cb48-16" aria-hidden="true" tabindex="-1"></a>coefs_lambdas <span class="sc">%&gt;%</span></span>
<span id="cb48-17"><a href="r-cheatsheet.html#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> coef, <span class="at">group =</span> term, <span class="at">color =</span> var)) <span class="sc">+</span></span>
<span id="cb48-18"><a href="r-cheatsheet.html#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb48-19"><a href="r-cheatsheet.html#cb48-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> best_se_penalty <span class="sc">%&gt;%</span> <span class="fu">pull</span>(penalty), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb48-20"><a href="r-cheatsheet.html#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb48-21"><a href="r-cheatsheet.html#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span></code></pre></div>
</div>
</div>
<div id="real-data-example-regression" class="section level2 unnumbered">
<h2>Real Data Example: Regression</h2>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="r-cheatsheet.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb49-2"><a href="r-cheatsheet.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidymodels_prefer</span>() </span>
<span id="cb49-3"><a href="r-cheatsheet.html#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="r-cheatsheet.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ames)</span>
<span id="cb49-5"><a href="r-cheatsheet.html#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="r-cheatsheet.html#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb49-7"><a href="r-cheatsheet.html#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="r-cheatsheet.html#cb49-8" aria-hidden="true" tabindex="-1"></a>ames <span class="ot">&lt;-</span> ames <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Sale_Price =</span> <span class="fu">log10</span>(Sale_Price))</span>
<span id="cb49-9"><a href="r-cheatsheet.html#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="r-cheatsheet.html#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># If you do one train/test split </span></span>
<span id="cb49-11"><a href="r-cheatsheet.html#cb49-11" aria-hidden="true" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(ames, <span class="at">strata =</span> <span class="st">&quot;Sale_Price&quot;</span>, <span class="at">prop =</span> <span class="fl">0.75</span>) <span class="co">#Create Train/Test set</span></span>
<span id="cb49-12"><a href="r-cheatsheet.html#cb49-12" aria-hidden="true" tabindex="-1"></a>ames_train <span class="ot">&lt;-</span> <span class="fu">training</span>(data_split) <span class="co"># Fit model to this</span></span>
<span id="cb49-13"><a href="r-cheatsheet.html#cb49-13" aria-hidden="true" tabindex="-1"></a>ames_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(data_split) <span class="co"># Don&#39;t use until evaluating final model</span></span></code></pre></div>
<div id="linear-regression" class="section level3 unnumbered">
<h3>Linear Regression</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="r-cheatsheet.html#cb50-1" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span> </span>
<span id="cb50-2"><a href="r-cheatsheet.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span>  <span class="co"># Specify Model and Engine</span></span>
<span id="cb50-3"><a href="r-cheatsheet.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>( <span class="at">engine =</span> <span class="st">&#39;lm&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="r-cheatsheet.html#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb50-5"><a href="r-cheatsheet.html#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="r-cheatsheet.html#cb50-6" aria-hidden="true" tabindex="-1"></a>lm_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> Lot_Area <span class="sc">+</span> Year_Built <span class="sc">+</span>  House_Style <span class="sc">+</span> Gr_Liv_Area <span class="sc">+</span> Fireplaces, <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="r-cheatsheet.html#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_lincomb</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span> <span class="co"># Specify Formula and Preprocessing Recipe</span></span>
<span id="cb50-8"><a href="r-cheatsheet.html#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="r-cheatsheet.html#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">Gr_Liv_Area =</span> Gr_Liv_Area<span class="sc">/</span><span class="dv">100</span>, <span class="at">Lot_Area =</span> Lot_Area<span class="sc">/</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-10"><a href="r-cheatsheet.html#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">Fireplaces =</span> Fireplaces <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-11"><a href="r-cheatsheet.html#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_cut</span>(Year_Built, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1950</span>, <span class="dv">1990</span>, <span class="dv">2020</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-12"><a href="r-cheatsheet.html#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_other</span>(House_Style,<span class="at">threshold =</span> .<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-13"><a href="r-cheatsheet.html#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb50-14"><a href="r-cheatsheet.html#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="r-cheatsheet.html#cb50-15" aria-hidden="true" tabindex="-1"></a>train_prep <span class="ot">&lt;-</span> lm_rec <span class="sc">%&gt;%</span> </span>
<span id="cb50-16"><a href="r-cheatsheet.html#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-17"><a href="r-cheatsheet.html#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() <span class="co"># Pre-process Training Data</span></span>
<span id="cb50-18"><a href="r-cheatsheet.html#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="r-cheatsheet.html#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="r-cheatsheet.html#cb50-20" aria-hidden="true" tabindex="-1"></a>ames_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> <span class="co"># Create Workflow (Recipe + Model Spec)</span></span>
<span id="cb50-21"><a href="r-cheatsheet.html#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(lm_rec) <span class="sc">%&gt;%</span></span>
<span id="cb50-22"><a href="r-cheatsheet.html#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_spec)  </span>
<span id="cb50-23"><a href="r-cheatsheet.html#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-24"><a href="r-cheatsheet.html#cb50-24" aria-hidden="true" tabindex="-1"></a>lm_fit_train <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span></span>
<span id="cb50-25"><a href="r-cheatsheet.html#cb50-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> ames_train)  <span class="co"># Fit Model to Training Data</span></span>
<span id="cb50-26"><a href="r-cheatsheet.html#cb50-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-27"><a href="r-cheatsheet.html#cb50-27" aria-hidden="true" tabindex="-1"></a>train_prep <span class="sc">%&gt;%</span></span>
<span id="cb50-28"><a href="r-cheatsheet.html#cb50-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sale_Price) <span class="sc">%&gt;%</span></span>
<span id="cb50-29"><a href="r-cheatsheet.html#cb50-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>( <span class="fu">predict</span>(lm_fit_train, ames_train) ) <span class="sc">%&gt;%</span> </span>
<span id="cb50-30"><a href="r-cheatsheet.html#cb50-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">metrics</span>(<span class="at">estimate =</span> .pred, <span class="at">truth =</span> Sale_Price)  <span class="co"># Calculate Training metrics</span></span>
<span id="cb50-31"><a href="r-cheatsheet.html#cb50-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-32"><a href="r-cheatsheet.html#cb50-32" aria-hidden="true" tabindex="-1"></a>lm_fit_train <span class="sc">%&gt;%</span></span>
<span id="cb50-33"><a href="r-cheatsheet.html#cb50-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="co"># Model Coefficients from Trained Model</span></span>
<span id="cb50-34"><a href="r-cheatsheet.html#cb50-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-35"><a href="r-cheatsheet.html#cb50-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dotwhisker)</span>
<span id="cb50-36"><a href="r-cheatsheet.html#cb50-36" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_fit_train) <span class="sc">%&gt;%</span>  <span class="co"># Viz of Trained Model Coef</span></span>
<span id="cb50-37"><a href="r-cheatsheet.html#cb50-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dwplot</span>(<span class="at">dot_args =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb50-38"><a href="r-cheatsheet.html#cb50-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">whisker_args =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb50-39"><a href="r-cheatsheet.html#cb50-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">vline =</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="at">linetype =</span> <span class="dv">2</span>))</span>
<span id="cb50-40"><a href="r-cheatsheet.html#cb50-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-41"><a href="r-cheatsheet.html#cb50-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-42"><a href="r-cheatsheet.html#cb50-42" aria-hidden="true" tabindex="-1"></a>ames_cv <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train, <span class="at">v =</span> <span class="dv">10</span>, <span class="at">strata =</span> Sale_Price) <span class="co"># Create 10 Folds of Training Data for CV</span></span>
<span id="cb50-43"><a href="r-cheatsheet.html#cb50-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-44"><a href="r-cheatsheet.html#cb50-44" aria-hidden="true" tabindex="-1"></a>lm_fit_cv <span class="ot">&lt;-</span> <span class="fu">fit_resamples</span>(ames_wf, <span class="co"># Fit Model to 10 Folds of Training Data</span></span>
<span id="cb50-45"><a href="r-cheatsheet.html#cb50-45" aria-hidden="true" tabindex="-1"></a>              <span class="at">resamples =</span> ames_cv,</span>
<span id="cb50-46"><a href="r-cheatsheet.html#cb50-46" aria-hidden="true" tabindex="-1"></a>              <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae, rsq))</span>
<span id="cb50-47"><a href="r-cheatsheet.html#cb50-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-48"><a href="r-cheatsheet.html#cb50-48" aria-hidden="true" tabindex="-1"></a>lm_fit_cv <span class="sc">%&gt;%</span> <span class="fu">collect_metrics</span>() <span class="co"># Evaluate Trained Model using CV</span></span>
<span id="cb50-49"><a href="r-cheatsheet.html#cb50-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-50"><a href="r-cheatsheet.html#cb50-50" aria-hidden="true" tabindex="-1"></a>lm_fit_test <span class="ot">&lt;-</span> <span class="fu">last_fit</span>(ames_wf,</span>
<span id="cb50-51"><a href="r-cheatsheet.html#cb50-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">split =</span> data_split) </span>
<span id="cb50-52"><a href="r-cheatsheet.html#cb50-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-53"><a href="r-cheatsheet.html#cb50-53" aria-hidden="true" tabindex="-1"></a>lm_fit_test <span class="sc">%&gt;%</span></span>
<span id="cb50-54"><a href="r-cheatsheet.html#cb50-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="co">#Evaluation on Test Data</span></span>
<span id="cb50-55"><a href="r-cheatsheet.html#cb50-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-56"><a href="r-cheatsheet.html#cb50-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-57"><a href="r-cheatsheet.html#cb50-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-58"><a href="r-cheatsheet.html#cb50-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb50-59"><a href="r-cheatsheet.html#cb50-59" aria-hidden="true" tabindex="-1"></a>conflicted<span class="sc">::</span><span class="fu">conflict_prefer</span>(<span class="st">&quot;vi&quot;</span>, <span class="st">&quot;vip&quot;</span>)</span>
<span id="cb50-60"><a href="r-cheatsheet.html#cb50-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-61"><a href="r-cheatsheet.html#cb50-61" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> lm_fit_train <span class="sc">%&gt;%</span> <span class="fu">extract_fit_engine</span>() </span>
<span id="cb50-62"><a href="r-cheatsheet.html#cb50-62" aria-hidden="true" tabindex="-1"></a><span class="fu">vi</span>(mod, <span class="at">method =</span> <span class="st">&#39;permute&#39;</span>, <span class="at">target =</span> <span class="st">&#39;Sale_Price&#39;</span>, <span class="at">metric =</span> <span class="st">&#39;rmse&#39;</span>, <span class="at">train =</span> train_prep, <span class="at">pred_wrapper =</span> predict)</span>
<span id="cb50-63"><a href="r-cheatsheet.html#cb50-63" aria-hidden="true" tabindex="-1"></a><span class="fu">vip</span>(mod, <span class="at">method =</span> <span class="st">&#39;permute&#39;</span>, <span class="at">target =</span> <span class="st">&#39;Sale_Price&#39;</span>, <span class="at">metric =</span> <span class="st">&#39;rmse&#39;</span>, <span class="at">train =</span> train_prep, <span class="at">pred_wrapper =</span> predict) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div id="regularized-regression" class="section level3 unnumbered">
<h3>Regularized Regression</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="r-cheatsheet.html#cb51-1" aria-hidden="true" tabindex="-1"></a>lm_lasso_spec <span class="ot">&lt;-</span> </span>
<span id="cb51-2"><a href="r-cheatsheet.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="r-cheatsheet.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="r-cheatsheet.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;glmnet&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="r-cheatsheet.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb51-6"><a href="r-cheatsheet.html#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="r-cheatsheet.html#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Update Workflow (Recipe + Model Spec)</span></span>
<span id="cb51-8"><a href="r-cheatsheet.html#cb51-8" aria-hidden="true" tabindex="-1"></a>ames_wf <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span> </span>
<span id="cb51-9"><a href="r-cheatsheet.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_model</span>(lm_lasso_spec)  </span>
<span id="cb51-10"><a href="r-cheatsheet.html#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="r-cheatsheet.html#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Tune Model by Fitting Model to 10 Folds of Training Data</span></span>
<span id="cb51-12"><a href="r-cheatsheet.html#cb51-12" aria-hidden="true" tabindex="-1"></a>lasso_fit_cv <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(ames_wf, </span>
<span id="cb51-13"><a href="r-cheatsheet.html#cb51-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">resamples =</span> ames_cv,</span>
<span id="cb51-14"><a href="r-cheatsheet.html#cb51-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">grid =</span> <span class="dv">10</span>,</span>
<span id="cb51-15"><a href="r-cheatsheet.html#cb51-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae, rsq))</span>
<span id="cb51-16"><a href="r-cheatsheet.html#cb51-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-17"><a href="r-cheatsheet.html#cb51-17" aria-hidden="true" tabindex="-1"></a>lasso_fit_cv <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="co"># Evaluate Trained Model using CV</span></span>
<span id="cb51-18"><a href="r-cheatsheet.html#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="r-cheatsheet.html#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Select penalty value</span></span>
<span id="cb51-20"><a href="r-cheatsheet.html#cb51-20" aria-hidden="true" tabindex="-1"></a>lasso_fit_cv <span class="sc">%&gt;%</span> <span class="fu">show_best</span>(<span class="at">metric =</span> <span class="st">&#39;rmse&#39;</span>)</span>
<span id="cb51-21"><a href="r-cheatsheet.html#cb51-21" aria-hidden="true" tabindex="-1"></a>best_penalty <span class="ot">&lt;-</span> lasso_fit_cv <span class="sc">%&gt;%</span> </span>
<span id="cb51-22"><a href="r-cheatsheet.html#cb51-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_by_one_std_err</span>(<span class="at">metric =</span> <span class="st">&#39;rmse&#39;</span>,<span class="fu">desc</span>(penalty))</span>
<span id="cb51-23"><a href="r-cheatsheet.html#cb51-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-24"><a href="r-cheatsheet.html#cb51-24" aria-hidden="true" tabindex="-1"></a>tuned_ames_wf <span class="ot">&lt;-</span>  <span class="fu">finalize_workflow</span>(ames_wf,best_penalty)</span>
<span id="cb51-25"><a href="r-cheatsheet.html#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="r-cheatsheet.html#cb51-26" aria-hidden="true" tabindex="-1"></a>lm_lasso_spec <span class="ot">&lt;-</span> tuned_ames_wf <span class="sc">%&gt;%</span> <span class="fu">pull_workflow_spec</span>() <span class="co"># Save final tuned model spec</span></span>
<span id="cb51-27"><a href="r-cheatsheet.html#cb51-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-28"><a href="r-cheatsheet.html#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="co"># CV metrics</span></span>
<span id="cb51-29"><a href="r-cheatsheet.html#cb51-29" aria-hidden="true" tabindex="-1"></a>lasso_fit_cv <span class="sc">%&gt;%</span> </span>
<span id="cb51-30"><a href="r-cheatsheet.html#cb51-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-31"><a href="r-cheatsheet.html#cb51-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(penalty <span class="sc">==</span> (best_penalty <span class="sc">%&gt;%</span> <span class="fu">pull</span>(penalty))) </span>
<span id="cb51-32"><a href="r-cheatsheet.html#cb51-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-33"><a href="r-cheatsheet.html#cb51-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Tuned Lasso Model to Training Data</span></span>
<span id="cb51-34"><a href="r-cheatsheet.html#cb51-34" aria-hidden="true" tabindex="-1"></a>lasso_fit_train <span class="ot">&lt;-</span> tuned_ames_wf <span class="sc">%&gt;%</span></span>
<span id="cb51-35"><a href="r-cheatsheet.html#cb51-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> ames_train)  </span>
<span id="cb51-36"><a href="r-cheatsheet.html#cb51-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-37"><a href="r-cheatsheet.html#cb51-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Training metrics</span></span>
<span id="cb51-38"><a href="r-cheatsheet.html#cb51-38" aria-hidden="true" tabindex="-1"></a>train_prep <span class="sc">%&gt;%</span></span>
<span id="cb51-39"><a href="r-cheatsheet.html#cb51-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sale_Price) <span class="sc">%&gt;%</span></span>
<span id="cb51-40"><a href="r-cheatsheet.html#cb51-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>( <span class="fu">predict</span>(lasso_fit_train, ames_train) ) <span class="sc">%&gt;%</span> </span>
<span id="cb51-41"><a href="r-cheatsheet.html#cb51-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">metrics</span>(<span class="at">estimate =</span> .pred, <span class="at">truth =</span> Sale_Price)  </span>
<span id="cb51-42"><a href="r-cheatsheet.html#cb51-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-43"><a href="r-cheatsheet.html#cb51-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Coefficients from Trained Model</span></span>
<span id="cb51-44"><a href="r-cheatsheet.html#cb51-44" aria-hidden="true" tabindex="-1"></a>lasso_fit_train <span class="sc">%&gt;%</span></span>
<span id="cb51-45"><a href="r-cheatsheet.html#cb51-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() </span>
<span id="cb51-46"><a href="r-cheatsheet.html#cb51-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-47"><a href="r-cheatsheet.html#cb51-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-48"><a href="r-cheatsheet.html#cb51-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Var Importance</span></span>
<span id="cb51-49"><a href="r-cheatsheet.html#cb51-49" aria-hidden="true" tabindex="-1"></a>glmnet_output <span class="ot">&lt;-</span> lasso_fit_train <span class="sc">%&gt;%</span> <span class="fu">extract_fit_engine</span>()</span>
<span id="cb51-50"><a href="r-cheatsheet.html#cb51-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-51"><a href="r-cheatsheet.html#cb51-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a boolean matrix (predictors x lambdas) of variable exclusion</span></span>
<span id="cb51-52"><a href="r-cheatsheet.html#cb51-52" aria-hidden="true" tabindex="-1"></a>bool_predictor_exclude <span class="ot">&lt;-</span> glmnet_output<span class="sc">$</span>beta<span class="sc">==</span><span class="dv">0</span></span>
<span id="cb51-53"><a href="r-cheatsheet.html#cb51-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-54"><a href="r-cheatsheet.html#cb51-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over each variable</span></span>
<span id="cb51-55"><a href="r-cheatsheet.html#cb51-55" aria-hidden="true" tabindex="-1"></a>var_imp <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(bool_predictor_exclude)), <span class="cf">function</span>(row) {</span>
<span id="cb51-56"><a href="r-cheatsheet.html#cb51-56" aria-hidden="true" tabindex="-1"></a>    this_coeff_path <span class="ot">&lt;-</span> bool_predictor_exclude[row,]</span>
<span id="cb51-57"><a href="r-cheatsheet.html#cb51-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">sum</span>(this_coeff_path) <span class="sc">==</span> <span class="fu">ncol</span>(bool_predictor_exclude)){ <span class="fu">return</span>(<span class="dv">0</span>)}<span class="cf">else</span>{</span>
<span id="cb51-58"><a href="r-cheatsheet.html#cb51-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">ncol</span>(bool_predictor_exclude) <span class="sc">-</span> <span class="fu">which.min</span>(this_coeff_path) <span class="sc">+</span> <span class="dv">1</span>)}</span>
<span id="cb51-59"><a href="r-cheatsheet.html#cb51-59" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb51-60"><a href="r-cheatsheet.html#cb51-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-61"><a href="r-cheatsheet.html#cb51-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataset of this information and sort</span></span>
<span id="cb51-62"><a href="r-cheatsheet.html#cb51-62" aria-hidden="true" tabindex="-1"></a>var_imp_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb51-63"><a href="r-cheatsheet.html#cb51-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">var_name =</span> <span class="fu">rownames</span>(bool_predictor_exclude),</span>
<span id="cb51-64"><a href="r-cheatsheet.html#cb51-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">var_imp =</span> var_imp</span>
<span id="cb51-65"><a href="r-cheatsheet.html#cb51-65" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-66"><a href="r-cheatsheet.html#cb51-66" aria-hidden="true" tabindex="-1"></a>var_imp_data <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(var_imp))</span></code></pre></div>
</div>
<div id="nearest-neighbors" class="section level3 unnumbered">
<h3>Nearest Neighbors</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="r-cheatsheet.html#cb52-1" aria-hidden="true" tabindex="-1"></a>knn_spec <span class="ot">&lt;-</span> </span>
<span id="cb52-2"><a href="r-cheatsheet.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nearest_neighbor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="r-cheatsheet.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_args</span>(<span class="at">neighbors =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="r-cheatsheet.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;kknn&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="r-cheatsheet.html#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb52-6"><a href="r-cheatsheet.html#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="r-cheatsheet.html#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Update Workflow (Recipe + Model Spec)</span></span>
<span id="cb52-8"><a href="r-cheatsheet.html#cb52-8" aria-hidden="true" tabindex="-1"></a>ames_wf <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span> </span>
<span id="cb52-9"><a href="r-cheatsheet.html#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_model</span>(knn_spec)  </span>
<span id="cb52-10"><a href="r-cheatsheet.html#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="r-cheatsheet.html#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Tune Model by Fitting Model to 10 Folds of Training Data</span></span>
<span id="cb52-12"><a href="r-cheatsheet.html#cb52-12" aria-hidden="true" tabindex="-1"></a>knn_fit_cv <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(ames_wf, </span>
<span id="cb52-13"><a href="r-cheatsheet.html#cb52-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">resamples =</span> ames_cv,</span>
<span id="cb52-14"><a href="r-cheatsheet.html#cb52-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">grid =</span> <span class="dv">20</span>,</span>
<span id="cb52-15"><a href="r-cheatsheet.html#cb52-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae, rsq))</span>
<span id="cb52-16"><a href="r-cheatsheet.html#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="r-cheatsheet.html#cb52-17" aria-hidden="true" tabindex="-1"></a>knn_fit_cv <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>() <span class="co"># Evaluate Trained Model using CV</span></span>
<span id="cb52-18"><a href="r-cheatsheet.html#cb52-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-19"><a href="r-cheatsheet.html#cb52-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-20"><a href="r-cheatsheet.html#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Select penalty value</span></span>
<span id="cb52-21"><a href="r-cheatsheet.html#cb52-21" aria-hidden="true" tabindex="-1"></a>knn_fit_cv <span class="sc">%&gt;%</span> <span class="fu">show_best</span>(<span class="at">metric =</span> <span class="st">&#39;rmse&#39;</span>)</span>
<span id="cb52-22"><a href="r-cheatsheet.html#cb52-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-23"><a href="r-cheatsheet.html#cb52-23" aria-hidden="true" tabindex="-1"></a>best_neighbor <span class="ot">&lt;-</span> knn_fit_cv <span class="sc">%&gt;%</span> </span>
<span id="cb52-24"><a href="r-cheatsheet.html#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_by_one_std_err</span>(<span class="at">metric =</span> <span class="st">&#39;rmse&#39;</span>, neighbors)</span>
<span id="cb52-25"><a href="r-cheatsheet.html#cb52-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-26"><a href="r-cheatsheet.html#cb52-26" aria-hidden="true" tabindex="-1"></a>tuned_ames_wf <span class="ot">&lt;-</span>  <span class="fu">finalize_workflow</span>(ames_wf, best_neighbor)</span>
<span id="cb52-27"><a href="r-cheatsheet.html#cb52-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-28"><a href="r-cheatsheet.html#cb52-28" aria-hidden="true" tabindex="-1"></a>knn_spec <span class="ot">&lt;-</span> tuned_ames_wf <span class="sc">%&gt;%</span> <span class="fu">pull_workflow_spec</span>() <span class="co"># Save final tuned model spec</span></span>
<span id="cb52-29"><a href="r-cheatsheet.html#cb52-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-30"><a href="r-cheatsheet.html#cb52-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-31"><a href="r-cheatsheet.html#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="co"># CV Metrics</span></span>
<span id="cb52-32"><a href="r-cheatsheet.html#cb52-32" aria-hidden="true" tabindex="-1"></a>knn_fit_cv <span class="sc">%&gt;%</span></span>
<span id="cb52-33"><a href="r-cheatsheet.html#cb52-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-34"><a href="r-cheatsheet.html#cb52-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neighbors <span class="sc">==</span> (best_neighbor <span class="sc">%&gt;%</span> <span class="fu">pull</span>(neighbors)))</span>
<span id="cb52-35"><a href="r-cheatsheet.html#cb52-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-36"><a href="r-cheatsheet.html#cb52-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-37"><a href="r-cheatsheet.html#cb52-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit KNN Model to Training Data</span></span>
<span id="cb52-38"><a href="r-cheatsheet.html#cb52-38" aria-hidden="true" tabindex="-1"></a>knn_fit_train <span class="ot">&lt;-</span> tuned_ames_wf <span class="sc">%&gt;%</span></span>
<span id="cb52-39"><a href="r-cheatsheet.html#cb52-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> ames_train)  </span>
<span id="cb52-40"><a href="r-cheatsheet.html#cb52-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-41"><a href="r-cheatsheet.html#cb52-41" aria-hidden="true" tabindex="-1"></a>train_prep <span class="sc">%&gt;%</span></span>
<span id="cb52-42"><a href="r-cheatsheet.html#cb52-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sale_Price) <span class="sc">%&gt;%</span></span>
<span id="cb52-43"><a href="r-cheatsheet.html#cb52-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>( <span class="fu">predict</span>(knn_fit_train, ames_train) ) <span class="sc">%&gt;%</span> </span>
<span id="cb52-44"><a href="r-cheatsheet.html#cb52-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">metrics</span>(<span class="at">estimate =</span> .pred, <span class="at">truth =</span> Sale_Price)  <span class="co"># Training metrics</span></span>
<span id="cb52-45"><a href="r-cheatsheet.html#cb52-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-46"><a href="r-cheatsheet.html#cb52-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-47"><a href="r-cheatsheet.html#cb52-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Predictions</span></span>
<span id="cb52-48"><a href="r-cheatsheet.html#cb52-48" aria-hidden="true" tabindex="-1"></a>data_grid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Lot_Area =</span> <span class="fu">median</span>(ames_train<span class="sc">$</span>Lot_Area),<span class="at">Year_Built =</span> <span class="fu">median</span>(ames_train<span class="sc">$</span>Year_Built), <span class="at">House_Style =</span> <span class="st">&#39;One_Story&#39;</span>, <span class="at">Fireplaces =</span> <span class="dv">1</span>, <span class="at">Gr_Liv_Area =</span> <span class="fu">seq</span>(<span class="dv">300</span>,<span class="dv">5000</span>,<span class="at">by =</span> <span class="dv">100</span>)) </span>
<span id="cb52-49"><a href="r-cheatsheet.html#cb52-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-50"><a href="r-cheatsheet.html#cb52-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Predicted Values for test values in data_grid</span></span>
<span id="cb52-51"><a href="r-cheatsheet.html#cb52-51" aria-hidden="true" tabindex="-1"></a>predicted_lines <span class="ot">&lt;-</span> data_grid <span class="sc">%&gt;%</span> </span>
<span id="cb52-52"><a href="r-cheatsheet.html#cb52-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb52-53"><a href="r-cheatsheet.html#cb52-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(knn_fit_train , <span class="at">new_data =</span> data_grid)</span>
<span id="cb52-54"><a href="r-cheatsheet.html#cb52-54" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb52-55"><a href="r-cheatsheet.html#cb52-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-56"><a href="r-cheatsheet.html#cb52-56" aria-hidden="true" tabindex="-1"></a>ames_train <span class="sc">%&gt;%</span></span>
<span id="cb52-57"><a href="r-cheatsheet.html#cb52-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Gr_Liv_Area, <span class="at">y =</span> Sale_Price)) <span class="sc">+</span> </span>
<span id="cb52-58"><a href="r-cheatsheet.html#cb52-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb52-59"><a href="r-cheatsheet.html#cb52-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .pred, <span class="at">x =</span> Gr_Liv_Area), <span class="at">data =</span> predicted_lines, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb52-60"><a href="r-cheatsheet.html#cb52-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div id="gams---splines-and-local-regression" class="section level3 unnumbered">
<h3>GAMs - Splines and Local Regression</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="r-cheatsheet.html#cb53-1" aria-hidden="true" tabindex="-1"></a>spline_rec <span class="ot">&lt;-</span> lm_rec <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="r-cheatsheet.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ns</span>(Gr_Liv_Area, <span class="at">deg_free =</span> <span class="dv">4</span>)</span>
<span id="cb53-3"><a href="r-cheatsheet.html#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="r-cheatsheet.html#cb53-4" aria-hidden="true" tabindex="-1"></a>ames_wf <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span> <span class="co"># Update Workflow (Recipe + Model Spec)</span></span>
<span id="cb53-5"><a href="r-cheatsheet.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_recipe</span>(spline_rec) <span class="sc">%&gt;%</span></span>
<span id="cb53-6"><a href="r-cheatsheet.html#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_model</span>(lm_spec)  </span>
<span id="cb53-7"><a href="r-cheatsheet.html#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="r-cheatsheet.html#cb53-8" aria-hidden="true" tabindex="-1"></a>spline_fit_train <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span></span>
<span id="cb53-9"><a href="r-cheatsheet.html#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> ames_train)  <span class="co"># Fit Spline Model to Training Data</span></span>
<span id="cb53-10"><a href="r-cheatsheet.html#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="r-cheatsheet.html#cb53-11" aria-hidden="true" tabindex="-1"></a>train_prep <span class="sc">%&gt;%</span></span>
<span id="cb53-12"><a href="r-cheatsheet.html#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sale_Price) <span class="sc">%&gt;%</span></span>
<span id="cb53-13"><a href="r-cheatsheet.html#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>( <span class="fu">predict</span>(spline_fit_train, ames_train) ) <span class="sc">%&gt;%</span> </span>
<span id="cb53-14"><a href="r-cheatsheet.html#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">metrics</span>(<span class="at">estimate =</span> .pred, <span class="at">truth =</span> Sale_Price)  <span class="co"># Training metrics</span></span>
<span id="cb53-15"><a href="r-cheatsheet.html#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="r-cheatsheet.html#cb53-16" aria-hidden="true" tabindex="-1"></a>spline_fit_cv <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span></span>
<span id="cb53-17"><a href="r-cheatsheet.html#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> ames_cv,</span>
<span id="cb53-18"><a href="r-cheatsheet.html#cb53-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae, rsq))</span>
<span id="cb53-19"><a href="r-cheatsheet.html#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="r-cheatsheet.html#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="co"># CV Metrics</span></span>
<span id="cb53-21"><a href="r-cheatsheet.html#cb53-21" aria-hidden="true" tabindex="-1"></a>spline_fit_cv <span class="sc">%&gt;%</span></span>
<span id="cb53-22"><a href="r-cheatsheet.html#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span>
<span id="cb53-23"><a href="r-cheatsheet.html#cb53-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-24"><a href="r-cheatsheet.html#cb53-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-25"><a href="r-cheatsheet.html#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="r-cheatsheet.html#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Predictions (Non-Linear Functions)</span></span>
<span id="cb53-27"><a href="r-cheatsheet.html#cb53-27" aria-hidden="true" tabindex="-1"></a>data_grid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Lot_Area =</span> <span class="fu">median</span>(ames_train<span class="sc">$</span>Lot_Area),<span class="at">Year_Built =</span> <span class="fu">median</span>(ames_train<span class="sc">$</span>Year_Built), <span class="at">House_Style =</span> <span class="st">&#39;One_Story&#39;</span>, <span class="at">Fireplaces =</span> <span class="dv">1</span>, <span class="at">Gr_Liv_Area =</span> <span class="fu">seq</span>(<span class="dv">300</span>,<span class="dv">5000</span>,<span class="at">by =</span> <span class="dv">100</span>)) </span>
<span id="cb53-28"><a href="r-cheatsheet.html#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="r-cheatsheet.html#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Predicted Values for test values in data_grid</span></span>
<span id="cb53-30"><a href="r-cheatsheet.html#cb53-30" aria-hidden="true" tabindex="-1"></a>predicted_lines <span class="ot">&lt;-</span> data_grid <span class="sc">%&gt;%</span> </span>
<span id="cb53-31"><a href="r-cheatsheet.html#cb53-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb53-32"><a href="r-cheatsheet.html#cb53-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(spline_fit_train , <span class="at">new_data =</span> data_grid)</span>
<span id="cb53-33"><a href="r-cheatsheet.html#cb53-33" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb53-34"><a href="r-cheatsheet.html#cb53-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-35"><a href="r-cheatsheet.html#cb53-35" aria-hidden="true" tabindex="-1"></a>ames_train <span class="sc">%&gt;%</span></span>
<span id="cb53-36"><a href="r-cheatsheet.html#cb53-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Gr_Liv_Area, <span class="at">y =</span> Sale_Price)) <span class="sc">+</span> </span>
<span id="cb53-37"><a href="r-cheatsheet.html#cb53-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-38"><a href="r-cheatsheet.html#cb53-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .pred, <span class="at">x =</span> Gr_Liv_Area), <span class="at">data =</span> predicted_lines, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb53-39"><a href="r-cheatsheet.html#cb53-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div id="gam---smoothing-splines" class="section level3 unnumbered">
<h3>GAM - Smoothing Splines</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="r-cheatsheet.html#cb54-1" aria-hidden="true" tabindex="-1"></a>gam_spec <span class="ot">&lt;-</span> </span>
<span id="cb54-2"><a href="r-cheatsheet.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gen_additive_mod</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="r-cheatsheet.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;mgcv&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="r-cheatsheet.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb54-5"><a href="r-cheatsheet.html#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="r-cheatsheet.html#cb54-6" aria-hidden="true" tabindex="-1"></a>fit_gam_model <span class="ot">&lt;-</span> gam_spec <span class="sc">%&gt;%</span> </span>
<span id="cb54-7"><a href="r-cheatsheet.html#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(Sale_Price <span class="sc">~</span> Lot_Area <span class="sc">+</span> Year_Built <span class="sc">+</span>  House_Style <span class="sc">+</span> <span class="fu">s</span>(Gr_Liv_Area, <span class="at">k =</span> <span class="dv">15</span>) <span class="sc">+</span> Fireplaces, <span class="at">data =</span> ames_train) </span>
<span id="cb54-8"><a href="r-cheatsheet.html#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="r-cheatsheet.html#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary: Parameter (linear) estimates and then Smooth Terms (H0: no relationship)</span></span>
<span id="cb54-10"><a href="r-cheatsheet.html#cb54-10" aria-hidden="true" tabindex="-1"></a>fit_gam_model <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>() </span>
<span id="cb54-11"><a href="r-cheatsheet.html#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="r-cheatsheet.html#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostics: Check to see if the number of knots is large enough (if p-value is low, increase number of knots)</span></span>
<span id="cb54-13"><a href="r-cheatsheet.html#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb54-14"><a href="r-cheatsheet.html#cb54-14" aria-hidden="true" tabindex="-1"></a>fit_gam_model <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> mgcv<span class="sc">::</span><span class="fu">gam.check</span>() </span>
<span id="cb54-15"><a href="r-cheatsheet.html#cb54-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-16"><a href="r-cheatsheet.html#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Non-Linear Functions</span></span>
<span id="cb54-17"><a href="r-cheatsheet.html#cb54-17" aria-hidden="true" tabindex="-1"></a>fit_gam_model <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">plot</span>() </span></code></pre></div>
</div>
<div id="regression-trees" class="section level3 unnumbered">
<h3>Regression Trees</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="r-cheatsheet.html#cb55-1" aria-hidden="true" tabindex="-1"></a>tree_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> Lot_Area <span class="sc">+</span> Year_Built <span class="sc">+</span>  House_Style <span class="sc">+</span> Gr_Liv_Area <span class="sc">+</span> Fireplaces, <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="r-cheatsheet.html#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_numeric_predictors</span>())</span>
<span id="cb55-3"><a href="r-cheatsheet.html#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="r-cheatsheet.html#cb55-4" aria-hidden="true" tabindex="-1"></a>tree_spec <span class="ot">&lt;-</span> </span>
<span id="cb55-5"><a href="r-cheatsheet.html#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">decision_tree</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-6"><a href="r-cheatsheet.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;rpart&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-7"><a href="r-cheatsheet.html#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb55-8"><a href="r-cheatsheet.html#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="r-cheatsheet.html#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="r-cheatsheet.html#cb55-10" aria-hidden="true" tabindex="-1"></a>ames_wf <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span> <span class="co"># Update Workflow (Recipe + Model Spec)</span></span>
<span id="cb55-11"><a href="r-cheatsheet.html#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_recipe</span>(tree_rec) <span class="sc">%&gt;%</span></span>
<span id="cb55-12"><a href="r-cheatsheet.html#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_model</span>(tree_spec)  </span>
<span id="cb55-13"><a href="r-cheatsheet.html#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="r-cheatsheet.html#cb55-14" aria-hidden="true" tabindex="-1"></a>tree_fit_train <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span></span>
<span id="cb55-15"><a href="r-cheatsheet.html#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> ames_train)  <span class="co"># Fit Reg Tree Model to Training Data</span></span>
<span id="cb55-16"><a href="r-cheatsheet.html#cb55-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a href="r-cheatsheet.html#cb55-17" aria-hidden="true" tabindex="-1"></a>train_prep <span class="sc">%&gt;%</span></span>
<span id="cb55-18"><a href="r-cheatsheet.html#cb55-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sale_Price) <span class="sc">%&gt;%</span></span>
<span id="cb55-19"><a href="r-cheatsheet.html#cb55-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>( <span class="fu">predict</span>(tree_fit_train, ames_train) ) <span class="sc">%&gt;%</span> </span>
<span id="cb55-20"><a href="r-cheatsheet.html#cb55-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">metrics</span>(<span class="at">estimate =</span> .pred, <span class="at">truth =</span> Sale_Price)  <span class="co"># Training metrics</span></span>
<span id="cb55-21"><a href="r-cheatsheet.html#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="r-cheatsheet.html#cb55-22" aria-hidden="true" tabindex="-1"></a>tree_fit_train <span class="sc">%&gt;%</span> </span>
<span id="cb55-23"><a href="r-cheatsheet.html#cb55-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb55-24"><a href="r-cheatsheet.html#cb55-24" aria-hidden="true" tabindex="-1"></a>  rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(<span class="at">roundint =</span> <span class="cn">FALSE</span>)</span>
<span id="cb55-25"><a href="r-cheatsheet.html#cb55-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-26"><a href="r-cheatsheet.html#cb55-26" aria-hidden="true" tabindex="-1"></a>tree_fit_cv <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span></span>
<span id="cb55-27"><a href="r-cheatsheet.html#cb55-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> ames_cv,</span>
<span id="cb55-28"><a href="r-cheatsheet.html#cb55-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae, rsq))</span>
<span id="cb55-29"><a href="r-cheatsheet.html#cb55-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-30"><a href="r-cheatsheet.html#cb55-30" aria-hidden="true" tabindex="-1"></a>tree_fit_cv <span class="sc">%&gt;%</span></span>
<span id="cb55-31"><a href="r-cheatsheet.html#cb55-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span></code></pre></div>
</div>
<div id="comparison-of-methods" class="section level3 unnumbered">
<h3>Comparison of Methods</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="r-cheatsheet.html#cb56-1" aria-hidden="true" tabindex="-1"></a>wf_set <span class="ot">&lt;-</span> <span class="fu">workflow_set</span>(</span>
<span id="cb56-2"><a href="r-cheatsheet.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">preproc =</span> <span class="fu">list</span>(<span class="at">lm =</span> lm_rec, <span class="at">spline =</span> spline_rec, <span class="at">tree =</span> tree_rec),</span>
<span id="cb56-3"><a href="r-cheatsheet.html#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">models =</span> <span class="fu">list</span>(<span class="at">lm =</span> lm_spec, <span class="at">lasso =</span> lm_lasso_spec, <span class="at">knn =</span> knn_spec, <span class="at">tree =</span> tree_spec),</span>
<span id="cb56-4"><a href="r-cheatsheet.html#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cross =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="r-cheatsheet.html#cb56-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">anti_join</span>(<span class="fu">tibble</span>(<span class="at">wflow_id =</span> <span class="fu">c</span>(<span class="st">&quot;lm_tree&quot;</span>,<span class="st">&quot;spline_lasso&quot;</span>, <span class="st">&quot;spline_knn&quot;</span>,<span class="st">&quot;spline_tree&quot;</span>,<span class="st">&quot;tree_lm&quot;</span>,<span class="st">&quot;tree_lasso&quot;</span>,<span class="st">&quot;tree_knn&quot;</span>)), </span>
<span id="cb56-6"><a href="r-cheatsheet.html#cb56-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="st">&quot;wflow_id&quot;</span>)</span>
<span id="cb56-7"><a href="r-cheatsheet.html#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="r-cheatsheet.html#cb56-8" aria-hidden="true" tabindex="-1"></a>ames_wf_set <span class="ot">&lt;-</span> wf_set <span class="sc">%&gt;%</span></span>
<span id="cb56-9"><a href="r-cheatsheet.html#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow_map</span>(</span>
<span id="cb56-10"><a href="r-cheatsheet.html#cb56-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fit_resamples&quot;</span>, </span>
<span id="cb56-11"><a href="r-cheatsheet.html#cb56-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> ames_cv, <span class="co"># Compare Methods via CV</span></span>
<span id="cb56-12"><a href="r-cheatsheet.html#cb56-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, rsq, mae)) </span>
<span id="cb56-13"><a href="r-cheatsheet.html#cb56-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-14"><a href="r-cheatsheet.html#cb56-14" aria-hidden="true" tabindex="-1"></a>ames_wf_set <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span>
<span id="cb56-15"><a href="r-cheatsheet.html#cb56-15" aria-hidden="true" tabindex="-1"></a>ames_wf_set <span class="sc">%&gt;%</span> <span class="fu">rank_results</span>(<span class="at">rank_metric =</span> <span class="st">&#39;rmse&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="r-cheatsheet.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">lm =</span> lm_fit_test, <span class="at">lasso =</span>  lasso_fit_test, <span class="at">knn =</span> knn_fit_test, <span class="at">spline =</span> spline_fit_test, <span class="at">tree =</span> tree_fit_test) <span class="sc">%&gt;%</span>  <span class="co"># Comparison of Methods fit to Test Data</span></span>
<span id="cb57-2"><a href="r-cheatsheet.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(collect_metrics, <span class="at">.id =</span> <span class="st">&#39;Model&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="r-cheatsheet.html#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Model, <span class="at">y =</span> .estimate)) <span class="sc">+</span></span>
<span id="cb57-4"><a href="r-cheatsheet.html#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb57-5"><a href="r-cheatsheet.html#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.metric <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span> </span>
<span id="cb57-6"><a href="r-cheatsheet.html#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="r-cheatsheet.html#cb58-1" aria-hidden="true" tabindex="-1"></a>new_ames <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">Fireplaces =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">Lot_Area =</span> <span class="fu">seq</span>(<span class="dv">1500</span>, <span class="dv">15000</span>, <span class="at">length =</span> <span class="dv">10</span>), <span class="at">Gr_Liv_Area =</span> <span class="fu">seq</span>(<span class="dv">500</span>, <span class="dv">5000</span>, <span class="at">length =</span> <span class="dv">10</span>), <span class="at">Year_Built =</span> <span class="fu">c</span>(<span class="dv">1900</span>,<span class="dv">1950</span>, <span class="dv">1975</span>,<span class="dv">2000</span>), <span class="at">House_Style =</span> <span class="fu">c</span>(<span class="st">&#39;One_Story&#39;</span>, <span class="st">&#39;Two_Story&#39;</span>,<span class="st">&#39;SLvl&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="r-cheatsheet.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Gr_Liv_Area <span class="sc">&gt;</span> Lot_Area))</span>
<span id="cb58-3"><a href="r-cheatsheet.html#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="r-cheatsheet.html#cb58-4" aria-hidden="true" tabindex="-1"></a>all_preds <span class="ot">&lt;-</span> new_ames <span class="sc">%&gt;%</span></span>
<span id="cb58-5"><a href="r-cheatsheet.html#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(lm_fit_train,new_ames)) <span class="sc">%&gt;%</span></span>
<span id="cb58-6"><a href="r-cheatsheet.html#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">.lm.pred =</span> .pred) <span class="sc">%&gt;%</span></span>
<span id="cb58-7"><a href="r-cheatsheet.html#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(lasso_fit_train,new_ames)) <span class="sc">%&gt;%</span></span>
<span id="cb58-8"><a href="r-cheatsheet.html#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">.lasso.pred =</span> .pred) <span class="sc">%&gt;%</span></span>
<span id="cb58-9"><a href="r-cheatsheet.html#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(knn_fit_train,new_ames)) <span class="sc">%&gt;%</span></span>
<span id="cb58-10"><a href="r-cheatsheet.html#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">.knn.pred =</span> .pred) <span class="sc">%&gt;%</span></span>
<span id="cb58-11"><a href="r-cheatsheet.html#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(spline_fit_train,new_ames)) <span class="sc">%&gt;%</span></span>
<span id="cb58-12"><a href="r-cheatsheet.html#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">.spline.pred =</span> .pred) <span class="sc">%&gt;%</span></span>
<span id="cb58-13"><a href="r-cheatsheet.html#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(tree_fit_train,new_ames)) <span class="sc">%&gt;%</span></span>
<span id="cb58-14"><a href="r-cheatsheet.html#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">.tree.pred =</span> .pred) </span>
<span id="cb58-15"><a href="r-cheatsheet.html#cb58-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-16"><a href="r-cheatsheet.html#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Predictions from these Models</span></span>
<span id="cb58-17"><a href="r-cheatsheet.html#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="r-cheatsheet.html#cb58-18" aria-hidden="true" tabindex="-1"></a>all_preds <span class="sc">%&gt;%</span></span>
<span id="cb58-19"><a href="r-cheatsheet.html#cb58-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year_Built <span class="sc">==</span> <span class="dv">1975</span> <span class="sc">&amp;</span> Fireplaces <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-20"><a href="r-cheatsheet.html#cb58-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Gr_Liv_Area, <span class="at">y =</span> .spline.pred, <span class="at">color =</span> House_Style )) <span class="sc">+</span></span>
<span id="cb58-21"><a href="r-cheatsheet.html#cb58-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb58-22"><a href="r-cheatsheet.html#cb58-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb58-23"><a href="r-cheatsheet.html#cb58-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Lot_Area) <span class="sc">+</span> </span>
<span id="cb58-24"><a href="r-cheatsheet.html#cb58-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
</div>
<div id="real-data-example-classification" class="section level2 unnumbered">
<h2>Real Data Example: Classification</h2>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="r-cheatsheet.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb59-2"><a href="r-cheatsheet.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidymodels_prefer</span>() </span>
<span id="cb59-3"><a href="r-cheatsheet.html#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="r-cheatsheet.html#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ames)</span>
<span id="cb59-5"><a href="r-cheatsheet.html#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="r-cheatsheet.html#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb59-7"><a href="r-cheatsheet.html#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="r-cheatsheet.html#cb59-8" aria-hidden="true" tabindex="-1"></a>ames <span class="ot">&lt;-</span> ames <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">High_Sale_Price =</span> <span class="fu">factor</span>(Sale_Price <span class="sc">&gt;</span> <span class="fu">quantile</span>(Sale_Price,.<span class="dv">75</span>)))</span>
<span id="cb59-9"><a href="r-cheatsheet.html#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="r-cheatsheet.html#cb59-10" aria-hidden="true" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(ames, <span class="at">strata =</span> <span class="st">&quot;High_Sale_Price&quot;</span>, <span class="at">prop =</span> <span class="fl">0.75</span>) <span class="co">#Create Train/Test set</span></span>
<span id="cb59-11"><a href="r-cheatsheet.html#cb59-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="r-cheatsheet.html#cb59-12" aria-hidden="true" tabindex="-1"></a>ames_train <span class="ot">&lt;-</span> <span class="fu">training</span>(data_split) <span class="co"># Fit model to this</span></span>
<span id="cb59-13"><a href="r-cheatsheet.html#cb59-13" aria-hidden="true" tabindex="-1"></a>ames_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(data_split) <span class="co"># Don&#39;t use until evaluating final model</span></span></code></pre></div>
<div id="logistic-regression" class="section level3 unnumbered">
<h3>Logistic Regression</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="r-cheatsheet.html#cb60-1" aria-hidden="true" tabindex="-1"></a>logistic_spec <span class="ot">&lt;-</span> </span>
<span id="cb60-2"><a href="r-cheatsheet.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span>  <span class="co"># Specify Model and Engine</span></span>
<span id="cb60-3"><a href="r-cheatsheet.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>( <span class="at">engine =</span> <span class="st">&#39;glm&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="r-cheatsheet.html#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;classification&#39;</span>) </span>
<span id="cb60-5"><a href="r-cheatsheet.html#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="r-cheatsheet.html#cb60-6" aria-hidden="true" tabindex="-1"></a>glm_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(High_Sale_Price <span class="sc">~</span> Lot_Area <span class="sc">+</span> Year_Built <span class="sc">+</span>  House_Style <span class="sc">+</span> Gr_Liv_Area <span class="sc">+</span> Fireplaces, <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb60-7"><a href="r-cheatsheet.html#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_lincomb</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span> <span class="co"># Specify Formula and Preprocessing Recipe</span></span>
<span id="cb60-8"><a href="r-cheatsheet.html#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb60-9"><a href="r-cheatsheet.html#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">Gr_Liv_Area =</span> Gr_Liv_Area<span class="sc">/</span><span class="dv">100</span>, <span class="at">Lot_Area =</span> Lot_Area<span class="sc">/</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-10"><a href="r-cheatsheet.html#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">Fireplaces =</span> Fireplaces <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-11"><a href="r-cheatsheet.html#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_cut</span>(Year_Built, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1950</span>, <span class="dv">1990</span>, <span class="dv">2020</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-12"><a href="r-cheatsheet.html#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_other</span>(House_Style,<span class="at">threshold =</span> .<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-13"><a href="r-cheatsheet.html#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb60-14"><a href="r-cheatsheet.html#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="r-cheatsheet.html#cb60-15" aria-hidden="true" tabindex="-1"></a>train_prep <span class="ot">&lt;-</span> glm_rec <span class="sc">%&gt;%</span> </span>
<span id="cb60-16"><a href="r-cheatsheet.html#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-17"><a href="r-cheatsheet.html#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>()  <span class="co"># Create Prepped Training Data</span></span>
<span id="cb60-18"><a href="r-cheatsheet.html#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="r-cheatsheet.html#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="r-cheatsheet.html#cb60-20" aria-hidden="true" tabindex="-1"></a>ames_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> <span class="co"># Create Workflow (Recipe + Model Spec)</span></span>
<span id="cb60-21"><a href="r-cheatsheet.html#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(glm_rec) <span class="sc">%&gt;%</span></span>
<span id="cb60-22"><a href="r-cheatsheet.html#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(logistic_spec)  </span>
<span id="cb60-23"><a href="r-cheatsheet.html#cb60-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-24"><a href="r-cheatsheet.html#cb60-24" aria-hidden="true" tabindex="-1"></a>logistic_fit_train <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span></span>
<span id="cb60-25"><a href="r-cheatsheet.html#cb60-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> ames_train)  <span class="co"># Fit Model to Training Data</span></span>
<span id="cb60-26"><a href="r-cheatsheet.html#cb60-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-27"><a href="r-cheatsheet.html#cb60-27" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_fit_train, ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb60-28"><a href="r-cheatsheet.html#cb60-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(train_prep <span class="sc">%&gt;%</span> <span class="fu">select</span>(High_Sale_Price)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-29"><a href="r-cheatsheet.html#cb60-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">metrics</span>(<span class="at">estimate =</span> .pred_class, <span class="at">truth =</span> High_Sale_Price)  <span class="co"># Training metrics</span></span>
<span id="cb60-30"><a href="r-cheatsheet.html#cb60-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-31"><a href="r-cheatsheet.html#cb60-31" aria-hidden="true" tabindex="-1"></a>logistic_fit_train <span class="sc">%&gt;%</span></span>
<span id="cb60-32"><a href="r-cheatsheet.html#cb60-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="co"># Model Coefficients from Trained Model</span></span>
<span id="cb60-33"><a href="r-cheatsheet.html#cb60-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-34"><a href="r-cheatsheet.html#cb60-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dotwhisker)</span>
<span id="cb60-35"><a href="r-cheatsheet.html#cb60-35" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(logistic_fit_train) <span class="sc">%&gt;%</span>  <span class="co"># Viz of Trained Model Odds Ratios</span></span>
<span id="cb60-36"><a href="r-cheatsheet.html#cb60-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">conf.low =</span> <span class="fu">exp</span>(estimate <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>std.error),<span class="at">conf.high =</span> <span class="fu">exp</span>(estimate <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>std.error)) <span class="sc">%&gt;%</span> <span class="co"># do this first</span></span>
<span id="cb60-37"><a href="r-cheatsheet.html#cb60-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">exp</span>(estimate)) <span class="sc">%&gt;%</span> <span class="co"># this second</span></span>
<span id="cb60-38"><a href="r-cheatsheet.html#cb60-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dwplot</span>(<span class="at">dot_args =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb60-39"><a href="r-cheatsheet.html#cb60-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">whisker_args =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb60-40"><a href="r-cheatsheet.html#cb60-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">vline =</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="at">linetype =</span> <span class="dv">2</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Odds Ratio&#39;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb60-41"><a href="r-cheatsheet.html#cb60-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-42"><a href="r-cheatsheet.html#cb60-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-43"><a href="r-cheatsheet.html#cb60-43" aria-hidden="true" tabindex="-1"></a>ames_cv <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train, <span class="at">v =</span> <span class="dv">10</span>, <span class="at">strata =</span> Sale_Price) <span class="co"># Create 10 Folds of Training Data for CV</span></span>
<span id="cb60-44"><a href="r-cheatsheet.html#cb60-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-45"><a href="r-cheatsheet.html#cb60-45" aria-hidden="true" tabindex="-1"></a>logistic_fit_cv <span class="ot">&lt;-</span> <span class="fu">fit_resamples</span>(ames_wf, <span class="co"># Fit Model to 10 Folds of Training Data</span></span>
<span id="cb60-46"><a href="r-cheatsheet.html#cb60-46" aria-hidden="true" tabindex="-1"></a>              <span class="at">resamples =</span> ames_cv,</span>
<span id="cb60-47"><a href="r-cheatsheet.html#cb60-47" aria-hidden="true" tabindex="-1"></a>              <span class="at">metrics =</span> <span class="fu">metric_set</span>(sens, spec, accuracy, roc_auc))</span>
<span id="cb60-48"><a href="r-cheatsheet.html#cb60-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-49"><a href="r-cheatsheet.html#cb60-49" aria-hidden="true" tabindex="-1"></a>logistic_fit_cv <span class="sc">%&gt;%</span> <span class="fu">collect_metrics</span>() <span class="co"># Evaluate Model using CV</span></span>
<span id="cb60-50"><a href="r-cheatsheet.html#cb60-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-51"><a href="r-cheatsheet.html#cb60-51" aria-hidden="true" tabindex="-1"></a>logistic_fit_test <span class="ot">&lt;-</span> <span class="fu">last_fit</span>(ames_wf,</span>
<span id="cb60-52"><a href="r-cheatsheet.html#cb60-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">split =</span> data_split,</span>
<span id="cb60-53"><a href="r-cheatsheet.html#cb60-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">metrics =</span> <span class="fu">metric_set</span>(sens, spec, accuracy, roc_auc)) </span>
<span id="cb60-54"><a href="r-cheatsheet.html#cb60-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-55"><a href="r-cheatsheet.html#cb60-55" aria-hidden="true" tabindex="-1"></a>logistic_fit_test <span class="sc">%&gt;%</span></span>
<span id="cb60-56"><a href="r-cheatsheet.html#cb60-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="co">#Evaluation on Test Data</span></span></code></pre></div>
</div>
<div id="regularized-logistic-regression" class="section level3 unnumbered">
<h3>Regularized Logistic Regression</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="r-cheatsheet.html#cb61-1" aria-hidden="true" tabindex="-1"></a>logistic_lasso_spec <span class="ot">&lt;-</span> </span>
<span id="cb61-2"><a href="r-cheatsheet.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="r-cheatsheet.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb61-4"><a href="r-cheatsheet.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;glmnet&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-5"><a href="r-cheatsheet.html#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;classification&#39;</span>) </span>
<span id="cb61-6"><a href="r-cheatsheet.html#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="r-cheatsheet.html#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="r-cheatsheet.html#cb61-8" aria-hidden="true" tabindex="-1"></a>ames_wf <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span> <span class="co"># Update Workflow (Recipe + Model Spec)</span></span>
<span id="cb61-9"><a href="r-cheatsheet.html#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_model</span>(logistic_lasso_spec)  </span>
<span id="cb61-10"><a href="r-cheatsheet.html#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="r-cheatsheet.html#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="r-cheatsheet.html#cb61-12" aria-hidden="true" tabindex="-1"></a>logistic_lasso_fit_cv <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(ames_wf, <span class="co"># Fit Model to 10 Folds of Training Data</span></span>
<span id="cb61-13"><a href="r-cheatsheet.html#cb61-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">resamples =</span> ames_cv,</span>
<span id="cb61-14"><a href="r-cheatsheet.html#cb61-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">grid =</span> <span class="dv">10</span>,</span>
<span id="cb61-15"><a href="r-cheatsheet.html#cb61-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">metrics =</span> <span class="fu">metric_set</span>(sens, spec, accuracy, roc_auc))</span>
<span id="cb61-16"><a href="r-cheatsheet.html#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="r-cheatsheet.html#cb61-17" aria-hidden="true" tabindex="-1"></a>logistic_lasso_fit_cv <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>() <span class="co"># Evaluate Trained Model using CV</span></span>
<span id="cb61-18"><a href="r-cheatsheet.html#cb61-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-19"><a href="r-cheatsheet.html#cb61-19" aria-hidden="true" tabindex="-1"></a>logistic_lasso_fit_cv <span class="sc">%&gt;%</span> <span class="fu">show_best</span>(<span class="at">metric =</span> <span class="st">&#39;roc_auc&#39;</span>)</span>
<span id="cb61-20"><a href="r-cheatsheet.html#cb61-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-21"><a href="r-cheatsheet.html#cb61-21" aria-hidden="true" tabindex="-1"></a>tuned_ames_wf <span class="ot">&lt;-</span> logistic_lasso_fit_cv <span class="sc">%&gt;%</span> </span>
<span id="cb61-22"><a href="r-cheatsheet.html#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">&#39;roc_auc&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb61-23"><a href="r-cheatsheet.html#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(ames_wf,.) <span class="co">#set penalty based on best fit</span></span>
<span id="cb61-24"><a href="r-cheatsheet.html#cb61-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-25"><a href="r-cheatsheet.html#cb61-25" aria-hidden="true" tabindex="-1"></a>logistic_lasso_spec <span class="ot">&lt;-</span> tuned_ames_wf <span class="sc">%&gt;%</span> <span class="fu">pull_workflow_spec</span>() <span class="co"># Save final tuned model spec</span></span>
<span id="cb61-26"><a href="r-cheatsheet.html#cb61-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-27"><a href="r-cheatsheet.html#cb61-27" aria-hidden="true" tabindex="-1"></a>logistic_lasso_fit_train <span class="ot">&lt;-</span> tuned_ames_wf <span class="sc">%&gt;%</span></span>
<span id="cb61-28"><a href="r-cheatsheet.html#cb61-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> ames_train)  <span class="co"># Fit Lasso Model to Training Data (penalty is now set)</span></span>
<span id="cb61-29"><a href="r-cheatsheet.html#cb61-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-30"><a href="r-cheatsheet.html#cb61-30" aria-hidden="true" tabindex="-1"></a>logistic_lasso_fit_train <span class="sc">%&gt;%</span></span>
<span id="cb61-31"><a href="r-cheatsheet.html#cb61-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb61-32"><a href="r-cheatsheet.html#cb61-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(train_prep <span class="sc">%&gt;%</span> <span class="fu">select</span>(High_Sale_Price)) <span class="sc">%&gt;%</span> </span>
<span id="cb61-33"><a href="r-cheatsheet.html#cb61-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">metrics</span>(<span class="at">estimate =</span> .pred_class, <span class="at">truth =</span> High_Sale_Price)  <span class="co"># Training metrics</span></span>
<span id="cb61-34"><a href="r-cheatsheet.html#cb61-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-35"><a href="r-cheatsheet.html#cb61-35" aria-hidden="true" tabindex="-1"></a>logistic_lasso_fit_train <span class="sc">%&gt;%</span></span>
<span id="cb61-36"><a href="r-cheatsheet.html#cb61-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="co"># Model Coefficients from Trained Model</span></span>
<span id="cb61-37"><a href="r-cheatsheet.html#cb61-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-38"><a href="r-cheatsheet.html#cb61-38" aria-hidden="true" tabindex="-1"></a>lasso_fit_test <span class="ot">&lt;-</span> <span class="fu">last_fit</span>(tuned_ames_wf,</span>
<span id="cb61-39"><a href="r-cheatsheet.html#cb61-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">split =</span> data_split,</span>
<span id="cb61-40"><a href="r-cheatsheet.html#cb61-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">metrics =</span> <span class="fu">metric_set</span>(sens, spec, accuracy, roc_auc)) </span>
<span id="cb61-41"><a href="r-cheatsheet.html#cb61-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-42"><a href="r-cheatsheet.html#cb61-42" aria-hidden="true" tabindex="-1"></a>lasso_fit_test <span class="sc">%&gt;%</span></span>
<span id="cb61-43"><a href="r-cheatsheet.html#cb61-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="co">#Evaluation on Test Data</span></span></code></pre></div>
</div>
<div id="classification-trees" class="section level3 unnumbered">
<h3>Classification Trees</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="r-cheatsheet.html#cb62-1" aria-hidden="true" tabindex="-1"></a>ctree_spec <span class="ot">&lt;-</span> </span>
<span id="cb62-2"><a href="r-cheatsheet.html#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">decision_tree</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="r-cheatsheet.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;rpart&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="r-cheatsheet.html#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;classification&#39;</span>) </span>
<span id="cb62-5"><a href="r-cheatsheet.html#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="r-cheatsheet.html#cb62-6" aria-hidden="true" tabindex="-1"></a>ames_wf <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span> <span class="co"># Update Workflow (Recipe + Model Spec)</span></span>
<span id="cb62-7"><a href="r-cheatsheet.html#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_model</span>(ctree_spec)  </span>
<span id="cb62-8"><a href="r-cheatsheet.html#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="r-cheatsheet.html#cb62-9" aria-hidden="true" tabindex="-1"></a>ctree_fit_train <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span></span>
<span id="cb62-10"><a href="r-cheatsheet.html#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> ames_train)  <span class="co"># Fit Reg Tree Model to Training Data</span></span>
<span id="cb62-11"><a href="r-cheatsheet.html#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="r-cheatsheet.html#cb62-12" aria-hidden="true" tabindex="-1"></a>ctree_fit_train <span class="sc">%&gt;%</span></span>
<span id="cb62-13"><a href="r-cheatsheet.html#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(ames_train)  <span class="sc">%&gt;%</span></span>
<span id="cb62-14"><a href="r-cheatsheet.html#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(train_prep <span class="sc">%&gt;%</span> <span class="fu">select</span>(High_Sale_Price)  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-15"><a href="r-cheatsheet.html#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">metrics</span>(<span class="at">estimate =</span> .pred_class, <span class="at">truth =</span> High_Sale_Price)  <span class="co"># Training metrics</span></span>
<span id="cb62-16"><a href="r-cheatsheet.html#cb62-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-17"><a href="r-cheatsheet.html#cb62-17" aria-hidden="true" tabindex="-1"></a>ctree_fit_train <span class="sc">%&gt;%</span> </span>
<span id="cb62-18"><a href="r-cheatsheet.html#cb62-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull_workflow_fit</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-19"><a href="r-cheatsheet.html#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-20"><a href="r-cheatsheet.html#cb62-20" aria-hidden="true" tabindex="-1"></a>  rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(<span class="at">roundint =</span> <span class="cn">FALSE</span>)</span>
<span id="cb62-21"><a href="r-cheatsheet.html#cb62-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-22"><a href="r-cheatsheet.html#cb62-22" aria-hidden="true" tabindex="-1"></a>ctree_fit_cv <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span></span>
<span id="cb62-23"><a href="r-cheatsheet.html#cb62-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> ames_cv,</span>
<span id="cb62-24"><a href="r-cheatsheet.html#cb62-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(sens,spec,accuracy,roc_auc))</span>
<span id="cb62-25"><a href="r-cheatsheet.html#cb62-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-26"><a href="r-cheatsheet.html#cb62-26" aria-hidden="true" tabindex="-1"></a>ctree_fit_cv <span class="sc">%&gt;%</span></span>
<span id="cb62-27"><a href="r-cheatsheet.html#cb62-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span>
<span id="cb62-28"><a href="r-cheatsheet.html#cb62-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-29"><a href="r-cheatsheet.html#cb62-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-30"><a href="r-cheatsheet.html#cb62-30" aria-hidden="true" tabindex="-1"></a><span class="fu">last_fit</span>(ames_wf,</span>
<span id="cb62-31"><a href="r-cheatsheet.html#cb62-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">split =</span> data_split,</span>
<span id="cb62-32"><a href="r-cheatsheet.html#cb62-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">metrics =</span> <span class="fu">metric_set</span>(sens,spec,accuracy,roc_auc)</span>
<span id="cb62-33"><a href="r-cheatsheet.html#cb62-33" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb62-34"><a href="r-cheatsheet.html#cb62-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="co"># Evaluation on Test Data</span></span></code></pre></div>
</div>
<div id="random-forest" class="section level3 unnumbered">
<h3>Random Forest</h3>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="r-cheatsheet.html#cb63-1" aria-hidden="true" tabindex="-1"></a>rf_spec <span class="ot">&lt;-</span> </span>
<span id="cb63-2"><a href="r-cheatsheet.html#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rand_forest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="r-cheatsheet.html#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;ranger&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="r-cheatsheet.html#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;classification&#39;</span>) </span>
<span id="cb63-5"><a href="r-cheatsheet.html#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="r-cheatsheet.html#cb63-6" aria-hidden="true" tabindex="-1"></a>ames_wf <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span> <span class="co"># Update Workflow (Recipe + Model Spec)</span></span>
<span id="cb63-7"><a href="r-cheatsheet.html#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_model</span>(rf_spec)  </span>
<span id="cb63-8"><a href="r-cheatsheet.html#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="r-cheatsheet.html#cb63-9" aria-hidden="true" tabindex="-1"></a>rf_fit_train <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span></span>
<span id="cb63-10"><a href="r-cheatsheet.html#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> ames_train)  <span class="co"># Fit Reg Tree Model to Training Data</span></span>
<span id="cb63-11"><a href="r-cheatsheet.html#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="r-cheatsheet.html#cb63-12" aria-hidden="true" tabindex="-1"></a>rf_fit_train <span class="sc">%&gt;%</span></span>
<span id="cb63-13"><a href="r-cheatsheet.html#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(ames_train)  <span class="sc">%&gt;%</span></span>
<span id="cb63-14"><a href="r-cheatsheet.html#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(train_prep <span class="sc">%&gt;%</span> <span class="fu">select</span>(High_Sale_Price)  ) <span class="sc">%&gt;%</span> </span>
<span id="cb63-15"><a href="r-cheatsheet.html#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">metrics</span>(<span class="at">estimate =</span> .pred_class, <span class="at">truth =</span> High_Sale_Price)  <span class="co"># Training metrics</span></span>
<span id="cb63-16"><a href="r-cheatsheet.html#cb63-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-17"><a href="r-cheatsheet.html#cb63-17" aria-hidden="true" tabindex="-1"></a>rf_fit_cv <span class="ot">&lt;-</span> ames_wf <span class="sc">%&gt;%</span></span>
<span id="cb63-18"><a href="r-cheatsheet.html#cb63-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> ames_cv,</span>
<span id="cb63-19"><a href="r-cheatsheet.html#cb63-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(sens,spec,accuracy,roc_auc))</span>
<span id="cb63-20"><a href="r-cheatsheet.html#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="r-cheatsheet.html#cb63-21" aria-hidden="true" tabindex="-1"></a>rf_fit_cv <span class="sc">%&gt;%</span></span>
<span id="cb63-22"><a href="r-cheatsheet.html#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span>
<span id="cb63-23"><a href="r-cheatsheet.html#cb63-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-24"><a href="r-cheatsheet.html#cb63-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-25"><a href="r-cheatsheet.html#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="fu">last_fit</span>(ames_wf,</span>
<span id="cb63-26"><a href="r-cheatsheet.html#cb63-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">split =</span> data_split,</span>
<span id="cb63-27"><a href="r-cheatsheet.html#cb63-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">metrics =</span> <span class="fu">metric_set</span>(sens,spec,accuracy,roc_auc)</span>
<span id="cb63-28"><a href="r-cheatsheet.html#cb63-28" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb63-29"><a href="r-cheatsheet.html#cb63-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="co"># Evaluation on Test Data</span></span></code></pre></div>
</div>
<div id="comparison-of-methods-1" class="section level3 unnumbered">
<h3>Comparison of Methods</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="r-cheatsheet.html#cb64-1" aria-hidden="true" tabindex="-1"></a>wf_set <span class="ot">&lt;-</span> <span class="fu">workflow_set</span>(</span>
<span id="cb64-2"><a href="r-cheatsheet.html#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">preproc =</span> <span class="fu">list</span>(glm_rec),</span>
<span id="cb64-3"><a href="r-cheatsheet.html#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">models =</span> <span class="fu">list</span>(<span class="at">logistic =</span> logistic_spec, <span class="at">lasso =</span> logistic_lasso_spec, <span class="at">tree =</span> ctree_spec, <span class="at">rf =</span> rf_spec),</span>
<span id="cb64-4"><a href="r-cheatsheet.html#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cross =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-5"><a href="r-cheatsheet.html#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="r-cheatsheet.html#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="r-cheatsheet.html#cb64-7" aria-hidden="true" tabindex="-1"></a>ames_wf_set <span class="ot">&lt;-</span> wf_set <span class="sc">%&gt;%</span></span>
<span id="cb64-8"><a href="r-cheatsheet.html#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow_map</span>(</span>
<span id="cb64-9"><a href="r-cheatsheet.html#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fit_resamples&quot;</span>, </span>
<span id="cb64-10"><a href="r-cheatsheet.html#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> ames_cv, <span class="co"># Compare Methods via CV</span></span>
<span id="cb64-11"><a href="r-cheatsheet.html#cb64-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy, sens, spec, roc_auc )) </span>
<span id="cb64-12"><a href="r-cheatsheet.html#cb64-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-13"><a href="r-cheatsheet.html#cb64-13" aria-hidden="true" tabindex="-1"></a>ames_wf_set <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span>
<span id="cb64-14"><a href="r-cheatsheet.html#cb64-14" aria-hidden="true" tabindex="-1"></a>ames_wf_set <span class="sc">%&gt;%</span> <span class="fu">rank_results</span>(<span class="at">rank_metric =</span> <span class="st">&#39;roc_auc &#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="real-data-example-clustering" class="section level2 unnumbered">
<h2>Real Data Example: Clustering</h2>
</div>
<div id="real-data-example-dimension-reduction" class="section level2 unnumbered">
<h2>Real Data Example: Dimension Reduction</h2>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="r-resources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introductions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
