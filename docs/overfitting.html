<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 3 Overfitting | STAT 253: Statistical Machine Learning</title>
  <meta name="description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 3 Overfitting | STAT 253: Statistical Machine Learning" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  <meta name="github-repo" content="bryandmartin/253_spring_2022" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 3 Overfitting | STAT 253: Statistical Machine Learning" />
  
  <meta name="twitter:description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="evaluating-regression-models.html"/>
<link rel="next" href="cross-validation.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="custom_styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href = "./">STAT 253: Statistical Machine Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="learning-goals.html"><a href="learning-goals.html"><i class="fa fa-check"></i>Learning Goals</a>
<ul>
<li class="chapter" data-level="" data-path="learning-goals.html"><a href="learning-goals.html#general-skills"><i class="fa fa-check"></i>General Skills</a></li>
<li class="chapter" data-level="" data-path="learning-goals.html"><a href="learning-goals.html#course-topics"><i class="fa fa-check"></i>Course Topics</a></li>
</ul></li>
<li class="part"><span><b>I R</b></span></li>
<li class="chapter" data-level="" data-path="r-and-rstudio-setup.html"><a href="r-and-rstudio-setup.html"><i class="fa fa-check"></i>R and RStudio Setup</a>
<ul>
<li class="chapter" data-level="" data-path="r-and-rstudio-setup.html"><a href="r-and-rstudio-setup.html#troubleshooting"><i class="fa fa-check"></i>Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html"><i class="fa fa-check"></i>R Resources</a>
<ul>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#tidymodels-resources"><i class="fa fa-check"></i>Tidymodels resources</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#tidyverse-resources"><i class="fa fa-check"></i>Tidyverse resources</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#visualization-resources"><i class="fa fa-check"></i>Visualization resources</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#general-r-resources"><i class="fa fa-check"></i>General R resources</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#free-online-textbooks"><i class="fa fa-check"></i>Free online textbooks</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#example-code"><i class="fa fa-check"></i>Example code</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html"><i class="fa fa-check"></i>R Cheatsheet</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#stat-155-review"><i class="fa fa-check"></i>Stat 155 Review</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#standard-linear-regression-models"><i class="fa fa-check"></i>Standard Linear Regression Models</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#standard-logistic-regression-models"><i class="fa fa-check"></i>Standard Logistic Regression Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#data-structures-and-purrr-package"><i class="fa fa-check"></i>Data Structures and Purrr Package</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#vectors-and-lists"><i class="fa fa-check"></i>Vectors and Lists</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#map"><i class="fa fa-check"></i>Map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#tidymodels-functions"><i class="fa fa-check"></i>Tidymodels Functions</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#model-specification"><i class="fa fa-check"></i>Model Specification</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#preprocessing-data"><i class="fa fa-check"></i>Preprocessing Data</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#data-subsets"><i class="fa fa-check"></i>Data Subsets</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#workflows"><i class="fa fa-check"></i>Workflows</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#fit-model"><i class="fa fa-check"></i>Fit Model</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#evaluate-model-metrics"><i class="fa fa-check"></i>Evaluate Model: Metrics</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#tune-model-choosing-tuning-parameters"><i class="fa fa-check"></i>Tune Model: Choosing tuning parameters</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#use-final-model-predictions"><i class="fa fa-check"></i>Use Final Model: Predictions</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#extraction"><i class="fa fa-check"></i>Extraction</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#variable-importance"><i class="fa fa-check"></i>Variable Importance</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#comparing-models-workflow-sets"><i class="fa fa-check"></i>Comparing Models: Workflow Sets</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#visualizing-fit-models"><i class="fa fa-check"></i>Visualizing Fit Models</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#visualize-coefficients"><i class="fa fa-check"></i>Visualize Coefficients</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#visualize-effects"><i class="fa fa-check"></i>Visualize Effects</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#visualize-residuals"><i class="fa fa-check"></i>Visualize Residuals</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#visualize-predictions"><i class="fa fa-check"></i>Visualize Predictions</a></li>
<li class="chapter" data-level="0.0.1" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#visualize-lasso-coefficients"><i class="fa fa-check"></i><b>0.0.1</b> Visualize LASSO Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#real-data-example-regression"><i class="fa fa-check"></i>Real Data Example: Regression</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#linear-regression"><i class="fa fa-check"></i>Linear Regression</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#regularized-regression"><i class="fa fa-check"></i>Regularized Regression</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#nearest-neighbors"><i class="fa fa-check"></i>Nearest Neighbors</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#gams---splines-and-local-regression"><i class="fa fa-check"></i>GAMs - Splines and Local Regression</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#gam---smoothing-splines"><i class="fa fa-check"></i>GAM - Smoothing Splines</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#regression-trees"><i class="fa fa-check"></i>Regression Trees</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#comparison-of-methods"><i class="fa fa-check"></i>Comparison of Methods</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#real-data-example-classification"><i class="fa fa-check"></i>Real Data Example: Classification</a>
<ul>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#logistic-regression"><i class="fa fa-check"></i>Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#regularized-logistic-regression"><i class="fa fa-check"></i>Regularized Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#classification-trees"><i class="fa fa-check"></i>Classification Trees</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#random-forest"><i class="fa fa-check"></i>Random Forest</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#comparison-of-methods-1"><i class="fa fa-check"></i>Comparison of Methods</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#real-data-example-clustering"><i class="fa fa-check"></i>Real Data Example: Clustering</a></li>
<li class="chapter" data-level="" data-path="r-cheatsheet.html"><a href="r-cheatsheet.html#real-data-example-dimension-reduction"><i class="fa fa-check"></i>Real Data Example: Dimension Reduction</a></li>
</ul></li>
<li class="part"><span><b>II Introductions</b></span></li>
<li class="chapter" data-level="1" data-path="introductions.html"><a href="introductions.html"><i class="fa fa-check"></i><b>1</b> Introductions</a>
<ul>
<li class="chapter" data-level="" data-path="introductions.html"><a href="introductions.html#envisioning-a-community-of-learners"><i class="fa fa-check"></i>Envisioning a Community of Learners</a></li>
<li class="chapter" data-level="" data-path="introductions.html"><a href="introductions.html#explorations"><i class="fa fa-check"></i>Explorations</a></li>
</ul></li>
<li class="part"><span><b>III Regression: Evaluation</b></span></li>
<li class="chapter" data-level="2" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html"><i class="fa fa-check"></i><b>2</b> Evaluating Regression Models</a>
<ul>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#learning-goals-1"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercises"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#context"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#class-investigations"><i class="fa fa-check"></i>Class investigations</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="overfitting.html"><a href="overfitting.html"><i class="fa fa-check"></i><b>3</b> Overfitting</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#learning-goals-2"><i class="fa fa-check"></i>Learning Goals</a></li>
<li><a href="overfitting.html#the-tidymodels-package">The <code>tidymodels</code> package</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercises-1"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#context-1"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-1-5-models"><i class="fa fa-check"></i>Exercise 1: 5 models</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-2-visualizing-predictions"><i class="fa fa-check"></i>Exercise 2: Visualizing Predictions</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-3-evaluating-on-test-data"><i class="fa fa-check"></i>Exercise 3: Evaluating on Test Data</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-4-overfitting"><i class="fa fa-check"></i>Exercise 4: Overfitting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cross-validation.html"><a href="cross-validation.html"><i class="fa fa-check"></i><b>4</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#learning-goals-3"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#writing-good-sentences"><i class="fa fa-check"></i>Writing Good Sentences</a>
<ul>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#instructions"><i class="fa fa-check"></i>Instructions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercises-2"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#context-2"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-1-cross-validation-in-concept"><i class="fa fa-check"></i>Exercise 1: Cross-validation in Concept</a></li>
<li><a href="cross-validation.html#exercise-2-cross-validation-with-tidymodels">Exercise 2: Cross-validation with <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-3-looking-at-the-evaluation-metrics"><i class="fa fa-check"></i>Exercise 3: Looking at the evaluation metrics</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-4-practical-issues-choosing-the-number-of-folds"><i class="fa fa-check"></i>Exercise 4: Practical issues: choosing the number of folds</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#digging-deeper"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Regression: Building Models</b></span></li>
<li class="chapter" data-level="5" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html"><i class="fa fa-check"></i><b>5</b> Variable Subset Selection</a>
<ul>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#learning-goals-4"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#writing-good-sentences-part-2"><i class="fa fa-check"></i>Writing Good Sentences Part 2</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercises-3"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-1-backward-stepwise-selection-by-hand"><i class="fa fa-check"></i>Exercise 1: Backward stepwise selection: by hand</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-2-interpreting-the-results"><i class="fa fa-check"></i>Exercise 2: Interpreting the results</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-3-planning-forward-selection-using-cv"><i class="fa fa-check"></i>Exercise 3: Planning forward selection using CV</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-4-approaches-to-variable-subset-selection"><i class="fa fa-check"></i>Exercise 4: Approaches to variable subset selection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html"><i class="fa fa-check"></i><b>6</b> LASSO: Shrinkage/Regularization</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#learning-goals-5"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#lasso-in-theory"><i class="fa fa-check"></i>LASSO in Theory</a></li>
<li><a href="lasso-shrinkageregularization.html#lasso-models-in-tidymodels">LASSO models in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercises-4"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-1-a-least-squares-model"><i class="fa fa-check"></i>Exercise 1: A least squares model</a></li>
<li><a href="lasso-shrinkageregularization.html#exercise-2-fitting-a-lasso-model-in-tidymodels">Exercise 2: Fitting a LASSO model in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-3-examining-output-plot-of-coefficient-paths"><i class="fa fa-check"></i>Exercise 3: Examining output: plot of coefficient paths</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-4-examining-and-evaluating-the-best-lasso-model"><i class="fa fa-check"></i>Exercise 4: Examining and evaluating the best LASSO model</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#digging-deeper-1"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Regression: Building Flexible Models</b></span></li>
<li class="chapter" data-level="7" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html"><i class="fa fa-check"></i><b>7</b> KNN Regression and the Bias-Variance Tradeoff</a>
<ul>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#learning-goals-6"><i class="fa fa-check"></i>Learning Goals</a></li>
<li><a href="knn-regression-and-the-bias-variance-tradeoff.html#knn-models-in-tidymodels">KNN models in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercises-5"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#hello-how-are-things"><i class="fa fa-check"></i>Hello, how are things?</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-1-bias-variance-tradeoff-warmup"><i class="fa fa-check"></i>Exercise 1: Bias-variance tradeoff warmup</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-2-impact-of-variable-scale-and-distance-measure"><i class="fa fa-check"></i>Exercise 2: Impact of variable scale and distance measure</a></li>
<li><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-3-implementing-knn-in-tidymodels">Exercise 3: Implementing KNN in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-4-inspecting-the-results"><i class="fa fa-check"></i>Exercise 4: Inspecting the results</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-5-curse-of-dimensionality"><i class="fa fa-check"></i>Exercise 5: Curse of dimensionality</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="catch-up-day.html"><a href="catch-up-day.html"><i class="fa fa-check"></i><b>8</b> Catch up Day</a>
<ul>
<li class="chapter" data-level="" data-path="catch-up-day.html"><a href="catch-up-day.html#learning-goals-7"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="catch-up-day.html"><a href="catch-up-day.html#content-conversation-1-prompts"><i class="fa fa-check"></i>Content Conversation 1 Prompts</a></li>
<li class="chapter" data-level="" data-path="catch-up-day.html"><a href="catch-up-day.html#peer-review"><i class="fa fa-check"></i>Peer Review</a></li>
<li class="chapter" data-level="" data-path="catch-up-day.html"><a href="catch-up-day.html#project-work"><i class="fa fa-check"></i>Project Work</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="splines.html"><a href="splines.html"><i class="fa fa-check"></i><b>9</b> Splines</a>
<ul>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#learning-goals-8"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#splines-1"><i class="fa fa-check"></i>Splines</a></li>
<li><a href="splines.html#splines-in-tidymodels">Splines in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#exercises-6"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#exercise-1-evaluating-a-fully-linear-model"><i class="fa fa-check"></i>Exercise 1: Evaluating a fully linear model</a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#exercise-2-evaluating-a-spline-model"><i class="fa fa-check"></i>Exercise 2: Evaluating a spline model</a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#extra-variable-scaling"><i class="fa fa-check"></i>Extra! Variable scaling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="local-regression-gams.html"><a href="local-regression-gams.html"><i class="fa fa-check"></i><b>10</b> Local Regression &amp; GAMs</a>
<ul>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#learning-goals-9"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#gams"><i class="fa fa-check"></i>GAMs</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#gams---options-for-fitting"><i class="fa fa-check"></i>GAMs - Options for Fitting</a>
<ul>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#gams-b-splines-ols"><i class="fa fa-check"></i>GAMs (B-splines + OLS)</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#gams-loess"><i class="fa fa-check"></i>GAMs (LOESS)</a></li>
<li><a href="local-regression-gams.html#gams-smoothing-splines-in-tidymodels">GAMs (smoothing splines) in <code>tidymodels</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercises-7"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-1-conceptual-warmup"><i class="fa fa-check"></i>Exercise 1: Conceptual warmup</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-2-using-loess"><i class="fa fa-check"></i>Exercise 2: Using LOESS</a></li>
<li><a href="local-regression-gams.html#exercise-3-building-a-gam-in-tidymodels">Exercise 3: Building a GAM in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-4-adjusting-the-best-gam"><i class="fa fa-check"></i>Exercise 4: Adjusting the “best” GAM</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-5-gam-with-recipes"><i class="fa fa-check"></i>Exercise 5: GAM with recipes</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-6-comparison-of-methods"><i class="fa fa-check"></i>Exercise 6: Comparison of methods</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VI Homework</b></span></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html"><i class="fa fa-check"></i>Homework 1</a>
<ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#project-work-1"><i class="fa fa-check"></i>Project Work</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#portfolio-work"><i class="fa fa-check"></i>Portfolio Work</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#reflection"><i class="fa fa-check"></i>Reflection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i>Homework 2</a>
<ul>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#project-work-2"><i class="fa fa-check"></i>Project Work</a>
<ul>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#instructions-1"><i class="fa fa-check"></i>Instructions</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#required-analyses"><i class="fa fa-check"></i>Required Analyses</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#portfolio-work-1"><i class="fa fa-check"></i>Portfolio Work</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#reflection-1"><i class="fa fa-check"></i>Reflection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html"><i class="fa fa-check"></i>Homework 3</a>
<ul>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#project-work-3"><i class="fa fa-check"></i>Project Work</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#portfolio-work-2"><i class="fa fa-check"></i>Portfolio Work</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#reflection-2"><i class="fa fa-check"></i>Reflection</a></li>
</ul></li>
<li class="part"><span><b>VII Project</b></span></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html"><i class="fa fa-check"></i>Final Project</a>
<ul>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#requirements"><i class="fa fa-check"></i>Requirements</a></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#expectations"><i class="fa fa-check"></i>Expectations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 253: Statistical Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="overfitting" class="section level1" number="3">
<h1><span class="header-section-number">Topic 3</span> Overfitting</h1>
<div id="learning-goals-2" class="section level2 unnumbered">
<h2>Learning Goals</h2>
<ul>
<li>Explain why training/in-sample model evaluation metrics can provide a misleading view of true test/out-of-sample performance</li>
<li>Implement testing and training sets in R using the <code>tidymodels</code> package</li>
</ul>
<p><br></p>
<p>Slides from today are available <a href="https://docs.google.com/presentation/d/1nQEQ5oF2rW3plkMVhsOMkA-ru-sbbm-0sqN_EUu3XqI/edit?usp=sharing">here</a>.</p>
<p><br><br><br></p>
</div>
<div id="the-tidymodels-package" class="section level2 unnumbered">
<h2>The <code>tidymodels</code> package</h2>
<p>Over this course, we will looking at a broad but linked set of specialized tools applied in statistical machine learning. Specialized tools generally require specialized code.</p>
<p>Each tool has been developed separately and coded in a unique way. In order to facilitate and streamline the user experience, there have been attempts at creating a uniform interface, such as the <code>caret</code> R package. The developers of the <code>caret</code> package are no longer maintaining those packages. They are working on a newer package, called <code>tidymodels</code>.</p>
<p>In this class, we will use the <code>tidymodels</code> package, which uses the tidyverse syntax you learned in Stat 155. The <code>tidymodels</code> package is a relatively new package and continues to be developed as we speak. This means that I’m learning with you and in a month or two, there may be improved functionality.</p>
<p>As I introduced in the R code videos, we have a general workflow structure that includes a model specification and a recipe (formula + preprocessing steps).</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="overfitting.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the package</span></span>
<span id="cb98-2"><a href="overfitting.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb98-3"><a href="overfitting.html#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidymodels_prefer</span>()</span>
<span id="cb98-4"><a href="overfitting.html#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="overfitting.html#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the seed for the random number generator</span></span>
<span id="cb98-6"><a href="overfitting.html#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb98-7"><a href="overfitting.html#cb98-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-8"><a href="overfitting.html#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify Model</span></span>
<span id="cb98-9"><a href="overfitting.html#cb98-9" aria-hidden="true" tabindex="-1"></a>model_spec <span class="ot">&lt;-</span></span>
<span id="cb98-10"><a href="overfitting.html#cb98-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> <span class="co"># type of model</span></span>
<span id="cb98-11"><a href="overfitting.html#cb98-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="at">engine =</span> __) <span class="sc">%&gt;%</span> <span class="co"># algorithm to fit the model</span></span>
<span id="cb98-12"><a href="overfitting.html#cb98-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_args</span>(__) <span class="sc">%&gt;%</span> <span class="co"># hyperparameters/tuning parameters are needed for some models</span></span>
<span id="cb98-13"><a href="overfitting.html#cb98-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_mode</span>(__) <span class="co"># regression or classification</span></span>
<span id="cb98-14"><a href="overfitting.html#cb98-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb98-15"><a href="overfitting.html#cb98-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify Recipe (if you have preprocessing steps)</span></span>
<span id="cb98-16"><a href="overfitting.html#cb98-16" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(formula, data) <span class="sc">%&gt;%</span></span>
<span id="cb98-17"><a href="overfitting.html#cb98-17" aria-hidden="true" tabindex="-1"></a>  step_{FILLIN}() <span class="sc">%&gt;%</span></span>
<span id="cb98-18"><a href="overfitting.html#cb98-18" aria-hidden="true" tabindex="-1"></a>  step_{FILLIN}() </span>
<span id="cb98-19"><a href="overfitting.html#cb98-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-20"><a href="overfitting.html#cb98-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Workflow (Model + Recipe)</span></span>
<span id="cb98-21"><a href="overfitting.html#cb98-21" aria-hidden="true" tabindex="-1"></a>model_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb98-22"><a href="overfitting.html#cb98-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_recipe</span>(rec) <span class="sc">%&gt;%</span> <span class="co">#or add_formula()</span></span>
<span id="cb98-23"><a href="overfitting.html#cb98-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_model</span>(model_spec)</span></code></pre></div>
<p>We can fit that workflow to training data.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="overfitting.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Model to training data (without a recipe)</span></span>
<span id="cb99-2"><a href="overfitting.html#cb99-2" aria-hidden="true" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="fu">fit</span>(model_spec, formula, data_train)</span>
<span id="cb99-3"><a href="overfitting.html#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="overfitting.html#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Model &amp; Recipe to training data</span></span>
<span id="cb99-5"><a href="overfitting.html#cb99-5" aria-hidden="true" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="fu">fit</span>(model_wf, data_train)</span></code></pre></div>
<p>And then we can evaluate that fit model on testing data (new data that has not been used to fit the model).</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="overfitting.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate on testing data</span></span>
<span id="cb100-2"><a href="overfitting.html#cb100-2" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> fit_model <span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="overfitting.html#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> data_test) <span class="sc">%&gt;%</span> <span class="co"># this function will apply recipe to new_data and do prediction</span></span>
<span id="cb100-4"><a href="overfitting.html#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_test)</span>
<span id="cb100-5"><a href="overfitting.html#cb100-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-6"><a href="overfitting.html#cb100-6" aria-hidden="true" tabindex="-1"></a>reg_metrics <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(rmse, rsq, mae)</span>
<span id="cb100-7"><a href="overfitting.html#cb100-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-8"><a href="overfitting.html#cb100-8" aria-hidden="true" tabindex="-1"></a>model_output <span class="sc">%&gt;%</span></span>
<span id="cb100-9"><a href="overfitting.html#cb100-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reg_metrics</span>(<span class="at">truth =</span> __, <span class="at">estimate =</span> .pred)</span></code></pre></div>
<p><br></p>
<p>The power of <code>tidymodels</code> is that it allows us to streamline the vast world of machine learning techniques into one common syntax. On top of <code>"lm"</code>, there are many other different machine learning methods that we can use.</p>
<p><br></p>
<p>In the exercises below, you’ll need to adapt the code above to fit a linear regression model (<code>engine = "lm"</code>).</p>
<p><br><br><br></p>
</div>
<div id="exercises-1" class="section level2 unnumbered">
<h2>Exercises</h2>
<p><strong>You can download a template RMarkdown file to start from <a href="template_rmds/03-overfitting.Rmd">here</a>.</strong></p>
<div id="context-1" class="section level3 unnumbered">
<h3>Context</h3>
<p>We’ll be working with a dataset containing physical measurements on 80 adult males. These measurements include body fat percentage estimates as well as body circumference measurements.</p>
<ul>
<li><code>fatBrozek</code>: Percent body fat using Brozek’s equation: 457/Density - 414.2</li>
<li><code>fatSiri</code>: Percent body fat using Siri’s equation: 495/Density - 450</li>
<li><code>density</code>: Density determined from underwater weighing (gm/cm^3).</li>
<li><code>age</code>: Age (years)</li>
<li><code>weight</code>: Weight (lbs)</li>
<li><code>height</code>: Height (inches)</li>
<li><code>neck</code>: Neck circumference (cm)</li>
<li><code>chest</code>: Chest circumference (cm)</li>
<li><code>abdomen</code>: Abdomen circumference (cm)</li>
<li><code>hip</code>: Hip circumference (cm)</li>
<li><code>thigh</code>: Thigh circumference (cm)</li>
<li><code>knee</code>: Knee circumference (cm)</li>
<li><code>ankle</code>: Ankle circumference (cm)</li>
<li><code>biceps</code>: Biceps (extended) circumference (cm)</li>
<li><code>forearm</code>: Forearm circumference (cm)</li>
<li><code>wrist</code>: Wrist circumference (cm)</li>
</ul>
<p>It takes a lot of effort to estimate body fat percentage accurately through underwater weighing. The goal is to build the best predictive model for <code>fatSiri</code> using just circumference measurements, which are more easily attainable. (We won’t use <code>fatBrozek</code> or <code>density</code> as predictors because they’re other outcome variables.)</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="overfitting.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb101-2"><a href="overfitting.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb101-3"><a href="overfitting.html#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb101-4"><a href="overfitting.html#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb101-5"><a href="overfitting.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidymodels_prefer</span>()</span>
<span id="cb101-6"><a href="overfitting.html#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="overfitting.html#cb101-7" aria-hidden="true" tabindex="-1"></a>bodyfat_train <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://www.dropbox.com/s/js2gxnazybokbzh/bodyfat_train.csv?dl=1&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 80 Columns: 17</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (17): fatBrozek, fatSiri, density, age, weight, height, neck, chest, abd...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="overfitting.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the fatBrozek and density variables (and one variable that a replicate of others)</span></span>
<span id="cb105-2"><a href="overfitting.html#cb105-2" aria-hidden="true" tabindex="-1"></a>bodyfat_train <span class="ot">&lt;-</span> bodyfat_train <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="overfitting.html#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>fatBrozek, <span class="sc">-</span>density, <span class="sc">-</span>hipin)</span></code></pre></div>
</div>
<div id="exercise-1-5-models" class="section level3 unnumbered">
<h3>Exercise 1: 5 models</h3>
<p>Consider the 5 models below:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="overfitting.html#cb106-1" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span></span>
<span id="cb106-2"><a href="overfitting.html#cb106-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb106-3"><a href="overfitting.html#cb106-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;lm&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb106-4"><a href="overfitting.html#cb106-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>)</span>
<span id="cb106-5"><a href="overfitting.html#cb106-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-6"><a href="overfitting.html#cb106-6" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">fit</span>(lm_spec,</span>
<span id="cb106-7"><a href="overfitting.html#cb106-7" aria-hidden="true" tabindex="-1"></a>            fatSiri <span class="sc">~</span> age<span class="sc">+</span>weight<span class="sc">+</span>neck<span class="sc">+</span>abdomen<span class="sc">+</span>thigh<span class="sc">+</span>forearm, </span>
<span id="cb106-8"><a href="overfitting.html#cb106-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> bodyfat_train)</span>
<span id="cb106-9"><a href="overfitting.html#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="overfitting.html#cb106-10" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">fit</span>(lm_spec,</span>
<span id="cb106-11"><a href="overfitting.html#cb106-11" aria-hidden="true" tabindex="-1"></a>            fatSiri <span class="sc">~</span> age<span class="sc">+</span>weight<span class="sc">+</span>neck<span class="sc">+</span>abdomen<span class="sc">+</span>thigh<span class="sc">+</span>forearm<span class="sc">+</span>biceps, </span>
<span id="cb106-12"><a href="overfitting.html#cb106-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> bodyfat_train)</span>
<span id="cb106-13"><a href="overfitting.html#cb106-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-14"><a href="overfitting.html#cb106-14" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">fit</span>(lm_spec,</span>
<span id="cb106-15"><a href="overfitting.html#cb106-15" aria-hidden="true" tabindex="-1"></a>            fatSiri <span class="sc">~</span> age<span class="sc">+</span>weight<span class="sc">+</span>neck<span class="sc">+</span>abdomen<span class="sc">+</span>thigh<span class="sc">+</span>forearm<span class="sc">+</span>biceps<span class="sc">+</span>chest<span class="sc">+</span>hip, </span>
<span id="cb106-16"><a href="overfitting.html#cb106-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> bodyfat_train)</span>
<span id="cb106-17"><a href="overfitting.html#cb106-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-18"><a href="overfitting.html#cb106-18" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">&lt;-</span> <span class="fu">fit</span>(lm_spec,</span>
<span id="cb106-19"><a href="overfitting.html#cb106-19" aria-hidden="true" tabindex="-1"></a>            fatSiri <span class="sc">~</span> .,  <span class="co"># The . means all predictors</span></span>
<span id="cb106-20"><a href="overfitting.html#cb106-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> bodyfat_train) </span>
<span id="cb106-21"><a href="overfitting.html#cb106-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-22"><a href="overfitting.html#cb106-22" aria-hidden="true" tabindex="-1"></a>bf_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(fatSiri <span class="sc">~</span> .,  <span class="at">data =</span> bodyfat_train) <span class="sc">%&gt;%</span></span>
<span id="cb106-23"><a href="overfitting.html#cb106-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>())</span>
<span id="cb106-24"><a href="overfitting.html#cb106-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-25"><a href="overfitting.html#cb106-25" aria-hidden="true" tabindex="-1"></a>bf_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb106-26"><a href="overfitting.html#cb106-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(bf_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb106-27"><a href="overfitting.html#cb106-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_spec) </span>
<span id="cb106-28"><a href="overfitting.html#cb106-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-29"><a href="overfitting.html#cb106-29" aria-hidden="true" tabindex="-1"></a>mod5 <span class="ot">&lt;-</span> <span class="fu">fit</span>(bf_wf,</span>
<span id="cb106-30"><a href="overfitting.html#cb106-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> bodyfat_train) </span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p><strong>STAT 155 review:</strong> Look at the <code>tidy()</code> of <code>mod1</code>. Contextually interpret the coefficient for the weight predictor. Is anything surprising? Why might this be?</p></li>
<li><p>Explain how mod5 is different than mod4. You may want to look at <code>bf_recipe %&gt;% prep(bodyfat_train) %&gt;% juice()</code> to see the preprocessed training data.</p></li>
<li><p>Which model will have the lowest training RMSE, and why? Explain before calculating (that is part d).</p></li>
<li><p>Compute the training RMSE for models 1 through 5 to check your answer for part c. Write a sentence interpreting one of values of RMSE in context.</p></li>
<li><p>Which model do you think is the “best”? You may calculate MAE and R squared as well to justify your answer.</p></li>
<li><p>Which model do you think will perform worst on new test data? Why?</p></li>
</ol>
</div>
<div id="exercise-2-visualizing-predictions" class="section level3 unnumbered">
<h3>Exercise 2: Visualizing Predictions</h3>
<ol style="list-style-type: lower-alpha">
<li>Sequentially run the code below, ending before pipe, comma, or +. For each row of code below, discuss what it does. Add comments to the end of the line after the pipe (with # in front) to explain what each line does.</li>
</ol>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="overfitting.html#cb107-1" aria-hidden="true" tabindex="-1"></a>mod5 <span class="sc">%&gt;%</span> <span class="co">#comment here</span></span>
<span id="cb107-2"><a href="overfitting.html#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb107-3"><a href="overfitting.html#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># </span></span>
<span id="cb107-4"><a href="overfitting.html#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lower =</span> estimate <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>std.error, <span class="at">upper =</span> estimate <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>std.error) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb107-5"><a href="overfitting.html#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="co"># </span></span>
<span id="cb107-6"><a href="overfitting.html#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="dv">4</span>) <span class="sc">+</span> <span class="co"># </span></span>
<span id="cb107-7"><a href="overfitting.html#cb107-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>estimate, <span class="at">y=</span>term)) <span class="sc">+</span> <span class="co"># </span></span>
<span id="cb107-8"><a href="overfitting.html#cb107-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y=</span>term, <span class="at">yend=</span>term, <span class="at">x=</span>lower, <span class="at">xend=</span>upper), <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">angle=</span><span class="dv">90</span>, <span class="at">ends=</span><span class="st">&#39;both&#39;</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&#39;cm&#39;</span>))) <span class="sc">+</span> <span class="co"># </span></span>
<span id="cb107-9"><a href="overfitting.html#cb107-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Coefficient estimate (95% CI)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Feature&#39;</span>) <span class="sc">+</span>  <span class="co">#</span></span>
<span id="cb107-10"><a href="overfitting.html#cb107-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="co">#</span></span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Sequentially run each line of code (below), end before pipe or comma. For each row of code below, discuss what it does. Add comments to the end of the line after the pipe (with # in front) to explain what each line does.</li>
</ol>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="overfitting.html#cb108-1" aria-hidden="true" tabindex="-1"></a>bodyfat_train <span class="sc">%&gt;%</span> <span class="co"># </span></span>
<span id="cb108-2"><a href="overfitting.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> <span class="co"># </span></span>
<span id="cb108-3"><a href="overfitting.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(fatSiri, id), <span class="at">names_to =</span> <span class="st">&#39;key&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>) <span class="sc">%&gt;%</span> <span class="co"># </span></span>
<span id="cb108-4"><a href="overfitting.html#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(  <span class="co"># </span></span>
<span id="cb108-5"><a href="overfitting.html#cb108-5" aria-hidden="true" tabindex="-1"></a>    (mod4 <span class="sc">%&gt;%</span>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(term, estimate)), <span class="co"># </span></span>
<span id="cb108-6"><a href="overfitting.html#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;key&#39;</span><span class="ot">=</span><span class="st">&#39;term&#39;</span>)</span>
<span id="cb108-7"><a href="overfitting.html#cb108-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="co">#right_join finishes here</span></span>
<span id="cb108-8"><a href="overfitting.html#cb108-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effect =</span> value <span class="sc">*</span> estimate) <span class="sc">%&gt;%</span> <span class="co"># </span></span>
<span id="cb108-9"><a href="overfitting.html#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> effect, <span class="at">y =</span> key)) <span class="sc">+</span> <span class="co"># </span></span>
<span id="cb108-10"><a href="overfitting.html#cb108-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="co"># </span></span>
<span id="cb108-11"><a href="overfitting.html#cb108-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> <span class="co"># </span></span>
<span id="cb108-12"><a href="overfitting.html#cb108-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Effect/Contribution to Predicted BodyFat Percent&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Feature&#39;</span>) <span class="sc">+</span>  <span class="co"># </span></span>
<span id="cb108-13"><a href="overfitting.html#cb108-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="co">#</span></span></code></pre></div>
</div>
<div id="exercise-3-evaluating-on-test-data" class="section level3 unnumbered">
<h3>Exercise 3: Evaluating on Test Data</h3>
<p>Now that you’ve thought about how well the models might perform on test data, deploy it in the real world by applying it to a new set of 172 adult males. You’ll need to update the <code>new_data</code> to use <code>bodyfat_test</code> instead of <code>bodyfat_train</code>.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="overfitting.html#cb109-1" aria-hidden="true" tabindex="-1"></a>bodyfat_test <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://www.dropbox.com/s/7gizws208u0oywq/bodyfat_test.csv?dl=1&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="overfitting.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use fit/trained models and evaluate on test data</span></span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p>Calculate the test RMSE, MAE, and R squared for all five of the models.</p></li>
<li><p>Look back to Exercise 1 and see which model you thought was “best” based on the training data. Is that the “best” model in terms of predicting on new data? Explain.</p></li>
<li><p>In “real life” we only have one data set. To get a sense of predictive performance on new test data, we could split our data into two groups. Discuss pros and cons of ways you might split the data. How big should the training set be? How big should the testing set be?</p></li>
</ol>
</div>
<div id="exercise-4-overfitting" class="section level3 unnumbered">
<h3>Exercise 4: Overfitting</h3>
<p>If you have time, consider the following relationship. Imagine a set of predictions that is overfit to this training data. You are not limited to lines. Draw a picture of that function of predictions on a piece of paper.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="overfitting.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb111-2"><a href="overfitting.html#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="overfitting.html#cb111-3" aria-hidden="true" tabindex="-1"></a>data_train <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb111-4"><a href="overfitting.html#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">15</span>,<span class="dv">0</span>,<span class="dv">7</span>),</span>
<span id="cb111-5"><a href="overfitting.html#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">15</span>,<span class="at">sd =</span> <span class="dv">7</span>)</span>
<span id="cb111-6"><a href="overfitting.html#cb111-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-7"><a href="overfitting.html#cb111-7" aria-hidden="true" tabindex="-1"></a>data_train <span class="sc">%&gt;%</span></span>
<span id="cb111-8"><a href="overfitting.html#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb111-9"><a href="overfitting.html#cb111-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb111-10"><a href="overfitting.html#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="stat253_manual_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="evaluating-regression-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cross-validation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
